<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- res.groups -->
        <record id="view_groups_form" model="ir.ui.view">
            <field name="name">res.groups.form</field>
            <field name="model">res.groups</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Groups" version="7.0">
                  <sheet>
                    <group col="4">
                        <field name="category_id"/>
                        <field name="name"/>
                    </group>
                    <notebook>
                        <page string="Users">
                            <field name="users"/>
                        </page>
                        <page string="Inherited">
                            <label string="Users added to this group are automatically added in the following groups."/>
                            <field name="implied_ids"/>
                        </page>
                        <page string="Menus">
                            <field name="menu_access"/>
                        </page>
                        <page string="Access Rights">
                            <field name="model_access">
                                <tree string="Access Rules" editable="top">
                                    <field name="model_id"/>
                                    <field name="perm_read"/>
                                    <field name="perm_write"/>
                                    <field name="perm_create"/>
                                    <field name="perm_unlink"/>
                                    <field name="name"/>
                                </tree>
                                <form string="Access Controls" version="7.0">
                                    <group col="4">
                                        <field name="name"/>
                                        <field name="model_id"/>
                                        <field name="perm_read"/>
                                        <field name="perm_write"/>
                                        <field name="perm_create"/>
                                        <field name="perm_unlink"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="Rules">
                            <field name="rule_groups">
                                <tree string="Rules">
                                    <field name="name"/>
                                    <field name="model_id"/>
                                    <field name="global"/>
                                </tree>
                            </field>
                        </page><page string="Notes">
                            <field name="comment"/>
                        </page>
                    </notebook>
                  </sheet>  
                </form>
            </field>
        </record>
        <record id="action_res_groups" model="ir.actions.act_window">
            <field name="name">Groups</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.groups</field>
            <field name="view_type">form</field>
            <field name="help">A group is a set of functional areas that will be assigned to the user in order to give them access and rights to specific applications and tasks in the system. You can create custom groups or edit the ones existing by default in order to customize the view of the menu that users will be able to see. Whether they can have a read, write, create and delete access right can be managed from here.</field>
        </record>
        <menuitem action="action_res_groups" id="menu_action_res_groups" parent="base.menu_users" groups="base.group_no_one"/>


        <!-- res.users -->
        <record id="view_users_form" model="ir.ui.view">
            <field name="name">res.users.form</field>
            <field name="model">res.users</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Users" version="7.0">
                    <field name="id" invisible="1"/>
                    <sheet>
                        <field name="avatar" widget='image' on_change="onchange_avatar(avatar)" class="oe_avatar oe_left"/>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name"/></h1>
                            <label for="login" class="oe_edit_only"/>
                            <h2><field name="login"/></h2>
                        </div>
                        <group>
                            <group>
                                <field name="new_password" password="True" attrs="{'required': [('id','=',False)]}"/>
                                <field name="company_id" context="{'user_preference': 0}"/>
                            </group>
                            <group>
                                <field name="active"/>
                            </group>
                        </group>

                        <notebook colspan="4">
                            <page string="Preferences">
                                <group>
                                    <group name="preferences">
                                        <field name="context_lang"/>
                                        <field name="context_tz"/>
                                    </group>
                                    <group groups="base.group_no_one">
                                        <field name="action_id"/>
                                        <field domain="[('usage','=','menu')]" name="menu_id" required="True"/>
                                    </group>
                                </group>
                                <group>
                                    <field name="user_email" widget="email"/>
                                    <field name="signature"/>
                                </group>
                            </page>
                            <page string="Access Rights">
                                <group string="Allowed Companies" groups="base.group_multi_company">
                                    <field name="company_ids" nolabel="1" widget="many2many_tags"/>
                                </group>
                                <group col="4">
                                    <field name="groups_id"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="view_users_tree" model="ir.ui.view">
            <field name="name">res.users.tree</field>
            <field name="model">res.users</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Users">
                    <field name="name"/>
                    <field name="login"/>
                    <field name="context_lang"/>
                    <field name="date"/>
                </tree>
            </field>
        </record>
        <record id="view_users_search" model="ir.ui.view">
            <field name="name">res.users.search</field>
            <field name="model">res.users</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Users">
                    <field name="name" filter_domain="['|', ('name','ilike',self), ('login','ilike',self)]" string="User"/>
                    <field name="company_ids" string="Company" groups="base.group_multi_company"/>
                </search>
            </field>
        </record>
        <record id="user_groups_view" model="ir.ui.view">
            <field name="name">res.users.groups</field>
            <field name="model">res.users</field>
            <field name="inherit_id" ref="view_users_form"/>
            <field name="arch" type="xml">
                <!-- dummy, will be modified by groups -->
                <field name="groups_id" position="after"/>
            </field>
        </record>
        <record id="action_res_users" model="ir.actions.act_window">
            <field name="name">Users</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.users</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_users_tree"/>
            <field name="search_view_id" ref="view_users_search"/>
            <field name="help">Create and manage users that will connect to the system. Users can be deactivated should there be a period of time during which they will/should not connect to the system. You can assign them groups in order to give them specific access to the applications they need to use in the system.</field>
        </record>
        <record id="action_res_users_view1" model="ir.actions.act_window.view">
            <field eval="10" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_users_tree"/>
            <field name="act_window_id" ref="action_res_users"/>
        </record>
        <record id="action_res_users_view2" model="ir.actions.act_window.view">
            <field eval="20" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_users_form"/>
            <field name="act_window_id" ref="action_res_users"/>
        </record>
        <menuitem action="action_res_users" id="menu_action_res_users" parent="base.menu_users"/>

        <record id="view_users_form_simple_modif" model="ir.ui.view">
            <field name="name">res.users.preferences.form</field>
            <field name="model">res.users</field>
            <field name="type">form</field>
            <field eval="18" name="priority"/>
            <field name="arch" type="xml">
                <form string="Users" version="7.0">
                   <sheet>
                    <div class="oe_right oe_avatar">
                        <field name="avatar" widget='image' on_change="onchange_avatar(avatar)"/>
                    </div>
                    <h1>
                        <field name="name" readonly="1" class="oe_inline"/>
                        (<field name="login" readonly="1" class="oe_inline"/>)
                    </h1>
                    <group col="4">
                        <field name="context_lang" readonly="0"/>
                        <field name="company_id" readonly="0"
                            groups="base.group_multi_company" on_change="on_change_company_id(company_id)"/>
                        <field name="context_tz" readonly="0"/>
                        <field name="company_id" widget="selection" readonly="0"
                            groups="base.group_multi_company" on_change="on_change_company_id(company_id)"/>
                    </group>
                    <group string="Email Preferences">
                        <field name="user_email" widget="email" readonly="0"/>
                        <field name="signature" readonly="0"/>
                    </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="action_res_users_my" model="ir.actions.act_window">
            <field name="name">Change My Preferences</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.users</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="domain">[('id','=',uid)]</field>
        </record>
        <record id="action_res_users_my_view1" model="ir.actions.act_window.view">
            <field eval="20" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="act_window_id" ref="action_res_users_my"/>
        </record>
        <record id="action_res_users_my_view2" model="ir.actions.act_window.view">
            <field eval="10" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_users_form_simple_modif"/>
            <field name="act_window_id" ref="action_res_users_my"/>
        </record>

    </data>
</openerp>
