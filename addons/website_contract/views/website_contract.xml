<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>


    <!-- Layout add nav and footer -->

    <template id="footer_custom" inherit_id="website.layout" name="Custom Footer">
        <xpath expr="//body/footer//a[@href='/page/website.aboutus']" position="after">
            <li><a href="/references/">References</a></li>
        </xpath>
    </template>

    <!-- Page --> 

    <template id="layout" name="References Layout">
        <t t-call="website.layout">
            <t t-set="title">References</t>
            <div class="container">
                <div class="row">
                    <t t-raw="ref_content" />
                </div>
            </div>
        </t>
    </template>

    <template id="index" name="References">
        <t t-call="website_contract.layout">
            <t t-set="ref_content">
                <h1 class="col-md-12 text-center">Trusted by millions worldwide</h1>
                <h2 class="col-md-12 text-center">Our public references</h2>
                <div class="col-md-12" id="ref_content">
                   <div class="navbar navbar-inverse">
                       <div class="navbar-collapse">
                           <t t-call="website.pager">
                              <t t-set="classname">pull-left</t>
                           </t>
                           <form action="/references/" method="get" class="navbar-search pull-right pagination">
                              <input type="text" name="search" class="search-query col-md-2 form-control" placeholder="Search" t-att-value="searches.get('search') or '' or ''" />
                           </form>
                       </div>
                   </div> 
                    <div>
                        <div t-foreach="partner_ids" t-as="partner" class="media thumbnail">
                            <a class="pull-left" t-attf-href="/references/#{ partner.id }/">
                                <img class="media-object" t-att-src="partner.img('image_small')"/>
                            </a>
                            <div class="media-body">
                                <t t-call="website.publish"><t t-set="object" t-value="partner"/></t>
                                <a class="media-heading" t-attf-href="/references/#{ partner.id }/"><small t-field="partner.parent_id"/> <small t-field="partner.name"/></a>
                                <div t-field="partner.website_short_description"/>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>

    <template id="ref_country" inherit_id="website_contract.index" inherit_option_id="website_contract.index" name="Left Country Categories">
        <xpath expr="//div[@id='ref_content']" position="before">
            <div class="col-md-4">
                <ul class="nav nav-pills nav-stacked">
                    <li class="nav-header">World Map</li>
                    <iframe t-attf-src="/worldmap/?width=320&amp;height=240&amp;partner_ids=#{ worldmap_partner_ids }&amp;partner_url=/references/"
                        style="width:320px; height:260px; border:0; padding:0; margin:0;"></iframe>
                    <li class="nav-header">Location</li>
                    <t t-foreach="countries">
                        <li t-if="country_id" t-att-class="searches.get('country') == str(country_id and country_id[0]) and 'active' or ''">
                            <a t-attf-href="/references/#{ search_path }&amp;country=#{ country_id[0] }"><t t-esc="country_id[1]"/><small>(<t t-esc="country_id_count"/>)</small></a>
                        </li>
                    </t>
                </ul>
            </div>
        </xpath>
        <xpath expr="//div[@id='ref_content']" position="attributes">
            <attribute name="class">col-md-8</attribute>
        </xpath>
    </template>

    <template id="details" name="Reference Detail">
        <t t-call="website_contract.layout">
            <t t-set="ref_content">
                <t t-call="website.publish"><t t-set="object" t-value="partner_id"/></t>
                <h1 class="col-md-12 text-center" t-field="partner_id.name"/>
                <div class="col-md-4">
                    <div class="text-center">
                        <img t-att-src="partner_id.img('image_medium')"/>
                    </div>
                        <address>
                        <table style="margin: auto;" class="well">
                            <colgroup>
                                <col width="100"/>
                                <col/>
                            </colgroup>
                            <tbody>
                                <t t-set="address" t-value="'&lt;br/&gt;'.join(partner_id.name_get()[0][1].split('\n')[1:])"/>
                                <tr t-if="address or editable"><th>Address</th><td class="col-md-2" t-raw="address"/></tr>
                                <tr t-if="partner_id.website or editable"><th>Website</th><td class="col-md-2" t-field="partner_id.website"/></tr>
                                <tr t-if="partner_id.phone or editable"><th>Tel</th><td class="col-md-2" t-field="partner_id.phone"/></tr>
                                <tr t-if="partner_id.mobile or editable"><th>Tel</th><td class="col-md-2" t-field="partner_id.mobile"/></tr>
                                <tr t-if="partner_id.fax or editable"><th>Fax</th><td class="col-md-2" t-field="partner_id.fax"/></tr>
                                <tr t-if="partner_id.email or editable"><th>Email</th><td class="col-md-2" t-field="partner_id.email"/></tr>
                            </tbody>
                        </table>
                    </address>
                </div>
                <div class="col-md-8 mt32" t-field="partner_id.website_description"/>
            </t>
        </t>
    </template>

 </data>
</openerp>
