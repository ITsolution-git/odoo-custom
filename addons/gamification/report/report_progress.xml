<?xml version="1.0" ?>
<openerp>
    <data>
        <!-- EDI related Email Templates menu -->
        <record model="ir.actions.act_window" id="action_email_templates">
            <field name="name">Email Templates</field>
            <field name="res_model">email.template</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="email_template.email_template_tree" />
            <field name="search_view_id" ref="email_template.view_email_template_search"/>
        </record>
        <menuitem id="menu_email_templates" parent="gamification_menu" action="action_email_templates" sequence="30" groups="base.group_no_one"/>

    </data>

    <!-- Mail template are declared in a NOUPDATE block
         so users can freely customize/delete them -->
    <data noupdate="1">
        <!--Email template -->
        <record id="email_template_edi_invoice" model="email.template">
            <field name="name">Individual Report - Send by Email</field>
            <field name="email_from">noreply@localhost</field>
            <field name="subject">${object.title}</field>
            <field name="email_recipients">${object.partner_id.id}</field>
            <field name="model_id" ref="gamification.goal.report"/>
            <field name="auto_delete" eval="True"/>
            <field name="report_name">Individual_Report_${(object.number or '').replace('/','_')}_${object.state == 'draft' and 'draft' or ''}</field>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFF; ">

    <h1>${report.title}</h1>

    <p>Hello ${report.user}, bellow are your latest results for the plan ${report.plan_name}.</p>

    <table width="100%" border="1">
    <tr>
        <th>Goal</th>
        <th>Target</th>
        <th>Current</th>
        <th>Completeness</th>
    </tr>
    % for goal in report:
        <tr>
            <td>${goal.type_id.name}</td>
            <td>${goal.target_goal}</td>
            <td>${goal.current}</td>
            <td>${goal.completeness} %</td>
        </tr>
    % endfor
    </table>

</div>
            ]]></field>
        </record>
    </data>
</openerp>
