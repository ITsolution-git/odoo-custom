<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- Extended View of Reconciliation Entry -->
         <record id="view_account_move_reconciliation_form_view" model="ir.ui.view">
            <field name="name">account.move.reconciliation.form</field>
            <field name="model">account.move.reconciliation</field>
            <field name="type">form</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <form string="Journal Item" layout="manual"  version="7.0">
                    <group>
                        <h3>
                            <a type="button" class="oe_pager_button" data-pager-action="previous">Previous</a>
                            <a type="button" class="oe_pager_button" data-pager-action="next">Next</a>
                            <field name="partner_id"/>
                            (<span class="oe_pager_index_extend">0</span><span class="oe_pager_separator"> / </span><span class="oe_pager_count_extend">0</span>)
                        </h3>
                        <div>
                            <label for="last_reconciliation_date"/>
                            <field name="last_reconciliation_date"  widget="date"/>
                            <label for="latest_date"/>
                            <field name="latest_date"/>
                        </div>
                        <div  class="oe_reconcile_row">
                            <a type="button" class="oe_reconcile  oe_reconcile_button" name="%(action_view_account_move_line_reconcile)d">Reconcile</a>
                            <a type="button" class="oe_nothing_to_reconcile  oe_reconcile_button" name="skip_partner">Nothing to Reconcile</a>
                            <field name="reconciliation_progress" widget="progressbar"/>
                        </div>         
                        <div name="grp_followup"  class="oe_reconcile_row">
                        </div>
                    </group>
                </form>
            </field>
        </record>

        <!-- Menu and Action -->
        <record id="action_account_receivable_manual_reconcile" model="ir.actions.act_window">
            <field name="name">Reconcile Customer Entries</field>
            <field name="res_model">account.move.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">account_reconciliation_list,form</field>
            <field eval="False" name="auto_search"/>
            <field name="context" eval="{'account_type':'receivable', 'search_default_unreconciled': 1}"></field>
        </record>
        
        <record id="action_account_payable_manual_reconcile" model="ir.actions.act_window">
            <field name="name">Reconcile Supplier Entries</field>
            <field name="res_model">account.move.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">account_reconciliation_list,form</field>
            <field eval="False" name="auto_search"/>
            <field name="context" eval="{'account_type':'payable', 'search_default_unreconciled': 1}"></field>
        </record>
        
        <record id="view_move_line_tree_reconciliation" model="ir.ui.view">
            <field name="name">account.move.line.account_reconciliation_list</field>
            <field name="model">account.move.line</field>
            <field eval="4" name="priority"/>
            <field name="arch" type="xml">
                <account_reconciliation_list version="7.0" colors="red:state == 'draft';black:state == 'valid'" string="Journal Items" editable="top" on_write="on_create_write">
                    <field name="date"/>
                    <field name="period_id"  invisible="1"/>
                    <field name="move_id"/>
                    <field name="ref"/>
                    <field name="invoice" invisible="1"/>
                    <field name="name" invisible="1" />
                    <field name="partner_id" invisible="1" on_change="onchange_partner_id(move_id, partner_id, account_id, debit, credit, date, journal_id)"/>
                    <field name="account_id" domain="[('journal_id','=',journal_id), ('company_id', '=', company_id)]"/>
                    <field name="journal_id"/>
                    <field name="debit" sum="Total debit"/>
                    <field name="credit" sum="Total credit"/>
                    <field name="account_tax_id"/>
                    <field name="analytic_account_id" groups="analytic.group_analytic_accounting" domain="[('parent_id','!=',False)]"/>
                    <field name="amount_currency" attrs="{'readonly':[('state','=','valid')]}"/>
                    <field name="currency_id" attrs="{'readonly':[('state','=','valid')]}" groups="base.group_multi_currency"/>
                    <field name="reconcile_partial_id"/>
                    <field name="reconcile_id"/>
                    <field name="state"/>
                </account_reconciliation_list>
            </field>
        </record>

        <menuitem
             name="Manual Reconciliation" icon="STOCK_EXECUTE"
             id="menu_manual_reconcile"
             parent="account.periodical_processing_reconciliation"/>

        <menuitem id="receivable_manual_reconcile" name="Reconcile Customer Entries"
         action="action_account_receivable_manual_reconcile"
         parent="account.menu_manual_reconcile"/>

        <menuitem id="payable_manual_reconcile" name="Reconcile Supplier Entries"
         action="action_account_payable_manual_reconcile"
         parent="account.menu_manual_reconcile"/>

    </data>
</openerp>
