<?xml version="1.0" ?>
<openerp>
	<data>
		<!--Export edi document  -->
		<record id="ir_actions_server_edi_invoice" model="ir.actions.server">
			<field name="code">context.update({'edi_web_url_view': '%s/edi/view_edi?db=%s&amp;token=%s' %(self.pool.get('ir.config_parameter').get_param(cr, uid, 'web.base.url'),cr.dbname, self.pool.get('ir.edi.document').export_edi(cr, uid, [object], context = context)[0])})
if object.partner_id.opt_out: self.pool.get('email.template').generate_mail(cr,
                      uid,
                      self.pool.get('ir.model.data').get_object_reference(cr, uid, 'account', 'email_template_edi_invoice')[1],
                      [object.id],
                      context=context)</field>
			<field eval="6" name="sequence"/>
			<field name="state">code</field>
			<field name="type">ir.actions.server</field>
			<field name="model_id" ref="account.model_account_invoice"/>
			<field name="condition">True</field>
			<field name="name">EDI Document - Invoice</field>
		</record>

		
		<!--calling multi action in workflow.activity -->
		<record id="account.act_open" model="workflow.activity">
			<field name="action_id" ref="ir_actions_server_edi_invoice"/>
		</record>

        
		<!--Email template -->
		<record id="email_template_edi_invoice" model="email.template">
			<field name="def_subject">${object.company_id.name} - Invoice ${object.number}</field>
			<field name="def_to">${object.address_invoice_id.email}</field>
			<field name="object_name" ref="account.model_account_invoice"/>
            <field name="use_sign">True</field>
			<field name="def_body_text">Hello ${object.partner_id.name},

We just registered the invoice ${object.number} for ${object.amount_total} ${object.currency_id.name} for your company ${object.company_id.name}.
You can click on the following link to preview, print and pay this invoice:

    ${object._context.get('edi_web_url_view')}

Please note that this invoice has to be paid before ${object.date_due}

Regards,
</field>
			<field name="template_language">mako</field>
			<field name="name">Mail Template of Invoice For EDI Document</field>
			<field name="model_int_name">account.invoice</field>
			<field name="reply_to">${object.user_id.email or ''}</field>
		</record>
	</data>
</openerp>
