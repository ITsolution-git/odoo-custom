<?xml version="1.0" ?>
<openerp>
	<data>
		<!--Export edi document  -->
		<record id="ir_actions_server_invoice" model="ir.actions.server">
			<field name="code">context.update({'token':self.pool.get('ir.edi.document').export_edi(cr, uid, [object], context = context),'invoice':object.number,'company':object.company_id.name,'currency':object.currency_id.name,'amount':object.amount_total,'date_due':object.date_due})</field>
			<field eval="6" name="sequence"/>
			<field name="state">code</field>
			<field name="type">ir.actions.server</field>
			<field name="model_id" ref="account.model_account_invoice"/>
			<field name="condition">True</field>
			<field name="name">invoice</field>
		</record>

		<!--send mail when invoice is creaed -->
		<record id="ir_actions_server_invoicesend" model="ir.actions.server">
			<field eval="7" name="sequence"/>
			<field name="message">hello</field>
			<field name="subject">invoice created</field>
			<field name="state">email</field>
			<field name="type">ir.actions.server</field>
			<field name="email">han@tinyerp.com</field>
			<field name="model_id" ref="account.model_account_invoice"/>
			<field name="condition">True</field>
			<field name="name">invoice_send</field>
		</record>

		<!--multi action for export edi and send email -->
		<record id="ir_actions_server_multiaction" model="ir.actions.server">
			<field eval="8" name="sequence"/>
			<field name="state">other</field>
			<field name="type">ir.actions.server</field>
			<field name="model_id" ref="account.model_account_invoice"/>
			<field eval="[(6,0,[ref('account.ir_actions_server_invoice'),ref('account.ir_actions_server_invoicesend')])]" name="child_ids"/>
			<field name="condition">True</field>
			<field name="name">Multi_action</field>
		</record>

		<!--calling multi action in workflow.activity -->
		<record id="account.act_open" model="workflow.activity">
			<field name="action_id" ref="ir_actions_server_multiaction"/>
		</record>

		<!--Email template -->
		<record id="email_template_invoice" model="email.template">
			<field model="email_template.account" name="from_account"/>
			<field name="def_subject">invoice</field>
			<field name="def_to">xyz</field>
			<field name="def_body_html"></field>
			<field name="object_name" ref="account.model_account_invoice"/>
			<field name="def_cc">xyz</field>
			<field name="def_body_text">
Hello,

We just registered the invoice ${object.number} for ${object.amount}, ${object.currency} for your company ${object.company}.
You can click on the following link to preview, print and pay this invoice:
    http://localhost:8080/openerp/token? ${object._context.get('token')}

Please note that this invoice has to be paid before ${object.date_due}

Regards,</field>
			<field name="template_language">mako</field>
			<field name="lang">english</field>
			<field name="def_bcc">xyz</field>
			<field name="name">Invoice</field>
			<field name="model_int_name">account.invoice</field>
			<field name="reply_to">xyz</field>
		</record>
	</data>
</openerp>
