-
  For test the procurement module, First I have to update  quantity.
-
  !python {model: product.product}: |
    product = self.browse(cr, uid, ref('product.product_product_pc2'))
    assert product.virtual_available >= 0.0,'Virtual stock have more quantities than zero.'
-
  I create minimum stock rule for product PC2.
-
  !record {model: stock.warehouse.orderpoint, id: stock_warehouse_orderpoint_op0}:
    company_id: base.main_company
    location_id: stock.stock_location_stock
    logic: max
    name: OP/000008
    product_id: product.product_product_pc2
    product_max_qty: 15.0
    product_min_qty: 5.0
    product_uom: product.product_uom_kgm
    qty_multiple: 1
    warehouse_id: stock.warehouse0
-
  I run the scheduler.
-
  !python {model: product.product}: |
    mk_procure = self.pool.get('make.procurement')
    procur_order = self.pool.get('procurement.order')
    product = self.browse(cr, uid, ref('product.product_product_pc2'))
    
    context.update({'active_model': 'product.product','active_id':ref('product.product_product_pc2')})
    values = mk_procure.default_get(cr, uid, ['qty','product_id','uom_id','warehouse_id','date_planned'], context)
    values.update({'warehouse_id': ref('base.main_company'),'uom_id': ref('product.product_uom_unit'),'qty': 5})
    
    ids = mk_procure.create(cr, uid, values, context)
    procurement = mk_procure.make_procurement(cr, uid, [ids], context)
    if product.virtual_available >= 5.0:
      proc_id = procurement.get('res_id')
      procurements = procur_order.browse(cr, uid, [proc_id])[0]
      obj = self.pool.get('procurement.orderpoint.compute')
      val = obj.default_get(cr, uid, ['automatic'], context)
      val.update({'automatic': True})
      new_id = obj.create(cr, uid, val, context)
      a = obj.procure_calculation(cr, uid, [proc_id], context)
      print a
    else:
      pass
      
      
