<?xml version="1.0"?>
<openerp>
    <data>

<!-- Idea Category Form View -->

    <menuitem name="Tools" id="base.menu_tools" icon="STOCK_PREFERENCES" sequence="15"/>
        <record model="ir.ui.view" id="view_idea_category_form">
            <field name="name">idea.category.form</field>
            <field name="model">idea.category</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Category of ideas">
                    <field name="name" select="1"/>
                    <field name="parent_id" select="1"/>
                    <newline/>
                    <separator string="Summary" colspan="4"/>
                    <field name="summary" colspan="4" nolabel="1"/>
                </form>
            </field>
        </record>

<!-- Idea Category Tree View -->

        <record model="ir.ui.view" id="view_idea_category_tree">
            <field name="name">idea.category.tree</field>
            <field name="model">idea.category</field>
            <field name="type">tree</field>
            <field name="field_parent">child_ids</field>
            <field name="arch" type="xml">
                <tree string="Category of ideas">
                    <field name="name"/>
                </tree>
            </field>
        </record>

<!-- Idea Category Action -->

    <record model="ir.actions.act_window" id="action_idea_category">
        <field name="name">Categories</field>
        <field name="res_model">idea.category</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem name="Configuration" parent="base.menu_tools"
         id="base.menu_lunch_survey_root" sequence="6"/>

    <menuitem name="Ideas" parent="base.menu_lunch_survey_root" id="menu_ideas"/>

    <menuitem name="Categories" parent="menu_ideas"
    	id="menu_idea_category" action="action_idea_category" />

<!-- Idea Category Action -->

    <record model="ir.actions.act_window" id="action_idea_category_tree">
        <field name="name">Ideas by Categories</field>
        <field name="res_model">idea.category</field>
        <field name="view_type">tree</field>
        <field name="domain">[('parent_id','=',False)]</field>
    </record>

    <menuitem name="Ideas" parent="base.menu_tools" id="menu_ideas1" sequence="4"/>

    <menuitem
        name="Ideas by Categories" parent="menu_ideas1"
        id="menu_idea_category_tree"
        action="action_idea_category_tree"/>

<!-- Oepn Ideas Action  -->

    <record model="ir.actions.act_window" id="action_idea_idea_categ_open">
        <field name="name">Open Ideas</field>
        <field name="res_model">idea.idea</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','open'),('category_id','child_of',[active_id])]</field>
    </record>

    <record model="ir.values" id="action_idea_idea_categ_open_val">
        <field name="key2" eval=" 'tree_but_open'" />
        <field name="model" eval="'idea.category'" />
        <field name="name">Ideas</field>
        <field name="value" eval="'ir.actions.act_window,'+str(action_idea_idea_categ_open)" />
        <field name="object" eval="True" />
    </record>

<!-- Idea statistics Form View -->

    <record model="ir.ui.view" id="view_idea_stat_form">
        <field name="name">idea.stat.form</field>
        <field name="model">idea.stat</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="stat">
                <field name="avgscore" />
                <field name="nbr_comments" />
                <field name="nbr_votes" />
            </form>
        </field>
    </record>

<!--Vote For Idea Tree View -->

    <record model="ir.ui.view" id="view_idea_vote_tree">
        <field name="name">idea.vote.tree</field>
        <field name="model">idea.vote</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
        <tree string="Votes">
            <field name="idea_id"/>
            <field name="user_id"/>
            <field name="score" />
        </tree>
        </field>
    </record>

<!--Vote For Idea Form View  -->

    <record model="ir.ui.view" id="view_idea_vote_form">
        <field name="name">idea.vote.form</field>
        <field name="model">idea.vote</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
        <form string="Votes">
            <field name="idea_id" select="1" />
            <field name="user_id" select="1" />
            <field name="score"/>
        </form>
        </field>
    </record>
    
<!-- Search view for Idea vote -->

    <record model="ir.ui.view" id="view_idea_vote_search">
        <field name="name">idea.vote.search</field>
        <field name="model">idea.vote</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
	        <search string="Ideas vote">
	        	<group col="10" colspan="4">
		            <field name="idea_id" widget="selection"/>
		            <field name="user_id" widget="selection"/>
				</group>
				<newline/>
	            <group expand="1" string="Group By..." colspan="14">
	                <filter string="Idea" icon="terp-crm" domain="[]" context="{'group_by':'idea_id'}"/>
	                <filter string="User" name="user" icon="terp-partner" domain="[]" context="{'group_by':'user_id'}"/>
	            </group>
	        </search>
        </field>
    </record>

<!-- New Idea Form View -->

    <record model="ir.ui.view" id="view_idea_idea_form">
        <field name="name">idea.idea.form</field>
        <field name="model">idea.idea</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
        <form string="New Idea">
            <notebook>
                <page string="Idea">
                    <field name="title" select="1" />
                    <field name="category_id" select="1"/>
                    <field name="date" />
                    <field name="user_id" select="1"/>
                    <field name="vote_avg" widget="progressbar"/>
                    <field name="vote_user"/>
                    <separator string="Description" colspan="4"/>
                    <field name="description" colspan="4" widget="text_wiki" nolabel="1"/>
                    <field name="state"/>
                    <group colspan="2" col="3">
                        <button name="idea_open" string="Open" states="draft" icon="gtk-go-forward"/>
                        <button name="idea_close" string="Close" states="open" icon="gtk-close" groups="base.group_extended"/>
                        <button name="idea_cancel" string="Cancel" states="open"  icon="gtk-cancel" groups="base.group_extended"/>
                    </group>
                </page>
                <page string="Comments">
                    <field name="comment_ids" nolabel="1" colspan="4">
                        <form string="Comment">
                        	<field name="user_id" colspan="2"/>
                            <separator string="User comment" colspan="4"/>
                            <field name="content" nolabel="1" colspan="4"/>
                        </form>
                    </field>
                </page>
                <page string="Vote">
                    <field name="vote_ids" nolabel="1" colspan="4" />
                </page>
                <page string="Statistics">
                    <field name="stat_vote_ids" colspan="4" mode="graph,tree" nolabel="1">
                        <graph string="vote_stat of ideas" type="bar">
                            <field name="score"/>
                            <field name="nbr"/>
                        </graph>
                        <tree string="vote_stat of ideas">
                            <field name="score"/>
                            <field name="nbr"/>
                        </tree>
                    </field>
                </page>
            </notebook>
        </form>
        </field>
    </record>

<!-- New Idea Tree View -->

    <record model="ir.ui.view" id="view_idea_idea_tree">
        <field name="name">idea.idea.tree</field>
        <field name="model">idea.idea</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
        <tree string="All Ideas">
            <field name="category_id" />
            <field name="create_date"/>
            <field name="user_id" />
            <field name="title"/>
            <field name="vote_avg" />
            <field name="count_comments" />
            <field name="count_votes" />
            <button name="%(action_idea_post_vote)d" icon="gtk-execute"
            	type="action" states="draft,open" string="Vote" />
        </tree>
        </field>
    </record>

<!-- Search Idea  -->

    <record model="ir.ui.view" id="view_idea_idea_search">
        <field name="name">idea.idea.search</field>
        <field name="model">idea.idea</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
	        <search string="Ideas">
	        	<group col="10" colspan="4">
		        	<filter icon="terp-project" string="My" domain="[('user_id','=',uid)]" help="My Ideas"/>
		        	<separator orientation="vertical"/>
		        	<filter icon="terp-project" string="Draft"
		        		domain="[('state','=','draft')]" help="Draft Ideas" />
		        	<filter icon="terp-project" string="Open"
		        		domain="[('state','=','open')]" help="Open Ideas" />
		        	<separator orientation="vertical"/>
		            <field name="title" select="1"/>
		            <field name="category_id" widget="selection"/>
		            <field name="user_id" widget="selection"/>
				</group>
				<newline/>
	            <group expand="1" string="Group By..." colspan="14">
	                <filter string="Category" icon="terp-crm" domain="[]" context="{'group_by':'category_id'}"/>
	                <filter string="State" icon="terp-crm" domain="[]" context="{'group_by':'state'}"/>
	                <separator orientation="vertical"/>
	                <filter string="Idea date" icon="terp-crm" domain="[]" context="{'group_by':'date'}"/>
	                <filter string="User" name="user" icon="terp-partner" domain="[]" context="{'group_by':'user_id'}"/>
	            </group>
	        </search>
        </field>
    </record>

<!-- Comments on Idea Tree View -->

    <record model="ir.ui.view" id="view_idea_comment_tree">
        <field name="name">idea.comment.tree</field>
        <field name="model">idea.comment</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
        <tree string="Comments">
            <field name="create_date" />
            <field name="user_id" />
            <field name="content" string="Comment" />
        </tree>
        </field>
    </record>

<!-- Idea Action -->

    <record model="ir.actions.act_window" id="action_idea_idea">
        <field name="name">Ideas</field>
        <field name="res_model">idea.idea</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_idea_idea_search"/>
    </record>

    <menuitem name="Ideas" parent="menu_ideas1" id="menu_idea_idea" action="action_idea_idea"/>

<!-- Open Idea Action  -->

    <record model="ir.actions.act_window" id="action_idea_idea_open">
        <field name="name">Open Ideas</field>
        <field name="res_model">idea.idea</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','open')]</field>
        <field name="filter" eval="True"/>
    </record>

<!-- Idea Votes Statistics Graph View -->

        <record model="ir.ui.view" id="view_idea_vote_stat_graph">
            <field name="name">idea.vote_stat.graph</field>
            <field name="model">idea.vote.stat</field>
            <field name="type">graph</field>
            <field name="arch" type="xml">
                <graph string="vote_stat of ideas">
                    <field name="score"/>
                    <field name="nbr"/>
                </graph>
            </field>
        </record>

<!-- Idea Votes Statistics Form View -->

        <record model="ir.ui.view" id="view_idea_vote_stat_form">
            <field name="name">idea.vote.stat.form</field>
            <field name="model">idea.vote.stat</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="vote_stat of ideas">
                    <field name="idea_id" select="1"/>
                    <field name="score"  select="1"/>
                    <field name="nbr" />
                </form>
            </field>
        </record>

<!-- Idea Votes Statistics Tree View -->

        <record model="ir.ui.view" id="view_idea_vote_stat_tree">
            <field name="name">idea.vote.stat.tree</field>
            <field name="model">idea.vote.stat</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="vote_stat of ideas">
                    <field name="idea_id"/>
                    <field name="score" />
                    <field name="nbr" />
                </tree>
            </field>
        </record>

<!-- Idea Votes Statistics Action -->

    <record model="ir.actions.act_window" id="action_idea_vote_stat">
        <field name="name">Statistics on Votes</field>
        <field name="res_model">idea.vote.stat</field>
        <field name="view_type">form</field>
        <field name="view_mode">graph,tree</field>
    </record>
	<menuitem name="Reporting" parent="base.menu_tools" id="base.menu_lunch_reporting" sequence="5"/>

	<menuitem name="Idea" parent="base.menu_lunch_reporting" id="menu_idea_reporting"/>

	<menuitem name="Vote Statistics" parent="menu_idea_reporting"
		id="menu_idea_vote_stat" action="action_idea_vote_stat" />

<!-- Vote For Idea Action  -->
	<record model="ir.actions.act_window" id="action_idea_vote">
        <field name="name">Idea's vote</field>
        <field name="res_model">idea.vote</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_idea_vote_search"/>
    </record>

    <menuitem name="All Votes" parent="menu_ideas" id="menu_idea_vote" action="action_idea_vote"/>

    </data>
</openerp>
