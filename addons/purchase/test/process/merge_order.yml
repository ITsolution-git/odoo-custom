-
  In order to merge RFQ, I merge two RFQ which has same supplier and check new merged order.
-
  !python {model: purchase.order}: |
    new_id = self.do_merge(cr, uid, [ref('order_purchase3'), ref('order_purchase7')])
    order3 = self.browse(cr, uid, ref('order_purchase3'))
    order7 = self.browse(cr, uid, ref('order_purchase7'))
    total_qty = sum([x.product_qty for x in order3.order_line] + [x.product_qty for x in order7.order_line])

    assert order3.state == 'cancel', "Merged order should be canceled"
    assert order7.state == 'cancel', "Merged order should be canceled"

    def merge(lines, line):
        res = {'product_id': line.product_id.id,'product_qty': line.product_qty}
        for line in lines:
            if res.get('product_id') == line.product_id.id:
                product_qty = res.get('product_qty') + line.product_qty
                res.update({'product_qty': product_qty})
        return res
    for order in self.browse(cr, uid, new_id.keys()):
       total_new_qty = [x.product_qty for x in order.order_line]
       total_new_qty = sum(total_new_qty)
       assert total_new_qty == total_qty,"product quantities are not correspond" 

            
       


