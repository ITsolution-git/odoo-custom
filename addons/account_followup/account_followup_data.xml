<?xml version="1.0"?>
<openerp>
    <!-- Mail template is done in a NOUPDATE block
         so users can freely customize/delete them -->
    <data noupdate="1">

<!--Mail template level 0-->
		 <record id="email_template_account_followup_level0" model="email.template">
            <field name="name">Follow-up of overdue invoices level 0</field>
            <field name="email_from">${user.email or ''}</field>
            <field name="subject">${object.company_id.name} Payments Follow-up</field>
            <field name="email_to">${object.email}</field>
            <field name="lang">${object.lang}</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255); ">
    
    <p>Dear ${object.name and ' ' or ''},</p>
    <p>
    Exception made if there was a mistake of ours, it seems that the following amount stays unpaid. Please, take
appropriate measures in order to carry out this payment in the next 8 days.
Would your payment have been carried out after this mail was sent, please ignore this message. Do not hesitate to
contact our accounting department at (+32).10.68.94.39.
Best Regards,
    </p>
<br/>
Best Regards,

   <br/>
${user.name}
    
<br/>
<br/>

    <table width=80%>

        <tr>
        	<td>Invoice date</td>
        	<td>Reference</td>
            <td>Due date</td>
            <td>Amount</td>            
            <td>Lit.</td>
        </tr>
<%
    amls = object.accountmoveline_ids
    mel = {}
    for aml in amls: 
        strbegin = "<TD> "
        strend = "</TD> "
        date = False
        if aml.date_maturity: 
            date = aml.date_maturity
            if aml.date_maturity <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
        else:
            if aml.date <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
            else:
                strbegin = "<TD>"
                strend = "</TD>"
            date = aml.date
        block = " "
        if aml.blocked: 
            block = "X"
        mel[aml.id] = strbegin + str(aml.date) + strend + strbegin + aml.ref + strend + strbegin + str(date) + strend + strbegin + str(aml.result) + strend + strbegin + block + strend
%>
<tr>
</tr>
% for aml in amls: 
<tr>
${mel[aml.id]}
</tr>
% endfor


</table>
<center>Total overdue amount: ${object.payment_amount_overdue} ${object.company_id.currency_id.name} </center>   
    <br/>
</div>
            ]]></field>
        </record>



		<!--Mail template level 1 -->
		 <record id="email_template_account_followup_level1" model="email.template">
            <field name="name">Follow-up of overdue invoices level 1</field>
            <field name="email_from">${user.email or ''}</field>
            <field name="subject">${object.company_id.name} Payments Follow-up</field>
            <field name="email_to">${object.email}</field>
            <field name="lang">${object.lang}</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255); ">
    
    <p>Dear ${object.name and ' ' or ''},</p>
   <p>
   	We are disappointed to see that despite sending a reminder, that your account is now seriously overdue.
It is essential that immediate payment is made, otherwise we will have to consider placing a stop on your account
which means that we will no longer be able to supply your company with (goods/services).
Please, take appropriate measures in order to carry out this payment in the next 8 days.
If there is a problem with paying invoice that we are not aware of, do not hesitate to contact our accounting
department at (+32).10.68.94.39. so that we can resolve the matter quickly.
Details of due payments is printed below.
 </p>
<br/>
Best Regards,
    
<br/>
${user.name}
    
<br/>
<br/>

    <table width=80%>

        <tr>
        	<td>Invoice date</td>
        	<td>Reference</td>
            <td>Due date</td>
            <td>Amount</td>            
            <td>Lit.</td>
        </tr>

<%
    amls = object.accountmoveline_ids
    mel = {}
    for aml in amls: 
        strbegin = "<TD> "
        strend = "</TD> "
        date = False
        if aml.date_maturity: 
            date = aml.date_maturity
            if aml.date_maturity <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
        else:
            if aml.date <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
            else:
                strbegin = "<TD>"
                strend = "</TD>"
            date = aml.date
        block = " "
        if aml.blocked: 
            block = "X"
        mel[aml.id] = strbegin + str(aml.date) + strend + strbegin + aml.ref + strend + strbegin + str(date) + strend + strbegin + str(aml.result) + strend + strbegin + block + strend
%>
<tr>
</tr>
% for aml in amls: 
<tr>
${mel[aml.id]}
</tr>
% endfor


</table>
<center>Total overdue amount: ${object.payment_amount_overdue} ${object.company_id.currency_id.name} </center>   
    <br/>
</div>
            ]]></field>
        </record>
        <!--Email template -->
        <record id="email_template_account_followup_level2" model="email.template">
            <field name="name">Follow-up of overdue invoices level 2</field>
            <field name="email_from">${user.email or ''}</field>
            <field name="subject">${object.company_id.name} Payments Follow-up</field>
            <field name="email_to">${object.email}</field>
            <field name="lang">${object.lang}</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255); ">
    
    <p>Dear ${object.name and ' ' or ''},</p>
    <p>
    Despite several reminders, your account is still not settled.
Unless full payment is made in next 8 days, legal action for the recovery of the debt will be taken without
further notice.
I trust that this action will prove unnecessary and details of due payments is printed below.
In case of any queries concerning this matter, do not hesitate to contact our accounting department at (+32).10.68.94.39.
</p>
<br/>
Best Regards,
    
<br/>
${user.name}
    
<br/>
<br/>

    <table width=80%>

        <tr>
        	<td>Invoice date</td>
        	<td>Reference</td>
            <td>Due date</td>
            <td>Amount</td>            
            <td>Lit.</td>
        </tr>

<%
    amls = object.accountmoveline_ids
    mel = {}
    for aml in amls: 
        strbegin = "<TD> "
        strend = "</TD> "
        date = False
        if aml.date_maturity: 
            date = aml.date_maturity
            if aml.date_maturity <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
        else:
            if aml.date <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
            else:
                strbegin = "<TD>"
                strend = "</TD>"
            date = aml.date
        block = " "
        if aml.blocked: 
            block = "X"
        mel[aml.id] = strbegin + str(aml.date) + strend + strbegin + aml.ref + strend + strbegin + str(date) + strend + strbegin + str(aml.result) + strend + strbegin + block + strend
%>
<tr>
</tr>
% for aml in amls: 
<tr>
${mel[aml.id]}
</tr>
% endfor


</table>
<center>Total overdue amount: ${object.payment_amount_overdue} ${object.company_id.currency_id.name}  </center>   
    <br/> 
    <br/>
</div>
            ]]></field>
        </record>
        
        <!-- Default follow up message -->
        
		 <record id="email_template_account_followup_default" model="email.template">
            <field name="name">Default follow-up of overdue invoices</field>
            <field name="email_from">${user.email or ''}</field>
            <field name="subject">${object.company_id.name} Payments Follow-up</field>
            <field name="email_to">${object.email}</field>
            <field name="lang">${object.lang}</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
<div style="font-family: 'Lucica Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255); ">
    
    <p>Dear ${object.name and ' ' or ''},</p>
    <p>
    Exception made if there was a mistake of ours, it seems that the following amount stays unpaid. Please, take
appropriate measures in order to carry out this payment in the next 8 days.
Would your payment have been carried out after this mail was sent, please ignore this message. Do not hesitate to
contact our accounting department at (+32).10.68.94.39.
    </p>
<br/>
Best Regards,
</br>
</br>
<br/>
${user.name}
    
<br/>
<br/>

    <table width=80%>

        <tr>
        	<td>Invoice date</td>
        	<td>Reference</td>
            <td>Due date</td>
            <td>Amount</td>            
            <td>Lit.</td>
        </tr>

<%
    amls = object.accountmoveline_ids
    mel = {}
    for aml in amls: 
        strbegin = "<TD> "
        strend = "</TD> "
        date = False
        if aml.date_maturity: 
            date = aml.date_maturity
            if aml.date_maturity <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
        else:
            if aml.date <= ctx['current_date'] and aml.debit > 0:
                strbegin = "<TD><B>"
                strend = "</B></TD>"
            else:
                strbegin = "<TD>"
                strend = "</TD>"
            date = aml.date
        block = " "
        if aml.blocked: 
            block = "X"
        mel[aml.id] = strbegin + str(aml.date) + strend + strbegin + aml.ref + strend + strbegin + str(date) + strend + strbegin + str(aml.result) + strend + strbegin + block + strend
%>
<tr>
</tr>
% for aml in amls: 
<tr>
${mel[aml.id]}
</tr>
% endfor

</table>
<center>Total overdue amount: ${object.payment_amount_overdue} ${object.company_id.currency_id.name} </center>   
    <br/>
</div>
            ]]></field>
        </record>
        
        
        
    </data>
</openerp>
