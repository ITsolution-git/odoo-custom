-
  In order to test the exclusive type requisition, I have to create two differ purchase order of one requisition [Tender]
-
  I select purchase requisition of '[CPU1] Processor AMD Athlon XP 1800+' and '[CPU3] Processor AMD Athlon XP 2200+'.
  So, those products must have requisition field checked.
-
  I start by Checking requisition field for '[CPU1] Processor AMD Athlon XP 1800+' product.
-
  !record {model: product.product, id: product.product_product_cpu1}:
    purchase_requisition: True
-
  Checked requisition field for '[CPU3] Processor AMD Athlon XP 2200+' product. 
-
  !record {model: product.product, id: product.product_product_cpu3}:
    purchase_requisition: True
-
  I search the purchase orders which have exclusive purchase requisition 'TE00001' and confirm any one of them.
  Then check the remaining purchase orders goes in to cancel state.
-
  !python {model: purchase.order}: |
    import netsvc
    wf_service = netsvc.LocalService("workflow")
    pur_order = self.pool.get('purchase.order')
    ids = pur_order.search(cr, uid, [('requisition_id','=',ref('order_purchase_requisition1'))])
    po_id = pur_order.browse(cr, uid, ids)
    for po in po_id:
      for line in po.order_line:
        if line.product_id.purchase_requisition == False:
          assert line.product_id.purchase_requisition == True, "Purchase Order's product must have requisition field checked"
    po_confirm = po_id[0].id
    wf_service.trg_validate(uid, 'purchase.order',po_confirm,'purchase_confirm', cr)
    assert po_id[0].state == 'approved',"After confirm a purchase order it should be in confirm state"
    assert po_id[1].state == 'cancel',"After confirmed a purchase order form the this requisition the second purchase order should be automatically goes in to cancelled state"

