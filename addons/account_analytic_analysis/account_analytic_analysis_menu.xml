<openerp>
    <data>
        <menuitem icon="terp-project" id="base.menu_main_pm" name="Project" sequence="10"/>
        <menuitem id="menu_invoicing" name="Billing" parent="base.menu_main_pm" sequence="4" groups="base.group_extended"/>

        <record id="action_hr_tree_invoiced_all" model="ir.actions.act_window">
            <field name="name">All Uninvoiced Entries</field>
            <field name="res_model">account.analytic.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('invoice_id','=',False),('to_invoice','!=',False)]</field>
            <field name="search_view_id" ref="account.view_account_analytic_line_filter"/>
        </record>
        <menuitem action="action_hr_tree_invoiced_all" id="menu_action_hr_tree_invoiced_all" parent="menu_invoicing" groups="base.group_extended"/>

        <record id="action_account_analytic_managed_overpassed" model="ir.actions.act_window">
            <field name="name">Overpassed Accounts</field>
            <field name="res_model">account.analytic.account</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="domain">[('date','&lt;=',time.strftime('%Y-%m-%d')),('state','=','open')]</field>
        </record>
        <menuitem action="action_account_analytic_managed_overpassed" id="menu_action_account_analytic_managed_overpassed" sequence="50" parent="menu_invoicing" groups="base.group_extended"/>

        <record id="view_account_analytic_account_overdue_search" model="ir.ui.view">
            <field name="name">account.analytic.account.search</field>
            <field name="model">account.analytic.account</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Analytic Account">
                    <group col="8" colspan="4">
                        <filter icon="terp-check" name="current" string="Current" domain="[('state', 'not in', ('closed', 'cancelled')]" help="Current Accounts" />
                        <filter icon="terp-camera_test" string="Open" domain="[('state','=','open')]" help="Open Accounts"/>
                        <filter icon="terp-gtk-media-pause" string="Pending" domain="[('state','=','pending')]" help="Pending Accounts"/>
                        <separator orientation="vertical"/>
                        <filter icon="terp-go-today" string="To Renew" domain="['|', '&amp;', ('date', '!=', False), ('date', '&lt;', time.strftime('%%Y-%%m-%%d')), ('is_overdue_quantity', '=', True)]"
                            help="The contracts to be renewed because the deadline is passed or the working hours are higher than the allocated hours" />
                        <filter icon="terp-go-month"
                             string=" +1 Month"
                             domain="[('date','&lt;=', (datetime.date.today() + relativedelta(months=1)).strftime('%%Y-%%m-%%d')),('date','>=', time.strftime('%%Y-%%m-%%d'))]"
                             help="Analytic Accounts with a past deadline in one month." />

                        <separator orientation="vertical"/>
                        <field name="name" select="1"/>
                        <field name="code" select="1"/>
                        <field name="partner_id" select="1">
                            <filter string="Has Partner" name="has_partner" domain="[('partner_id', '!=', False)]" icon="terp-partner" />
                            <filter string="Has No Partner" name="has_no_partner" domain="[('partner_id', '=', False)]" icon="terp-partner" />
                        </field>
                        <field name="user_id">
                            <filter string="My Accounts" domain="[('user_id','=',uid)]" icon="terp-personal" name="my_accounts" />
                            <filter string="No Account Manager" domain="[('user_id', '=', False)]" icon="terp-personal-" />
                        </field>

                    </group>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Manager" icon="terp-personal" domain="[]" context="{'group_by':'user_id'}"/>
                        <filter string="Associated Partner" icon="terp-partner" domain="[]" context="{'group_by':'partner_id'}"/>
                        <separator orientation="vertical"/>
                        <filter string="Parent" icon="terp-folder-orange" domain="[]" context="{'group_by':'parent_id'}"/>
                        <!--
                        <filter string="Start Date" icon="terp-go-month" domain="[]" context="{'group_by' : 'date_start'}" />
                        -->
                        <filter string="End Date" icon="terp-go-month" domain="[]" context="{'group_by' : 'date'}" />
                    </group>
                </search>
            </field>
        </record>


        <record id="action_account_analytic_overdue" model="ir.actions.act_window">
            <field name="name">Overdue Accounts</field>
            <field name="res_model">account.analytic.account</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="context">{'search_default_has_partner' : 1, 'search_default_my_accounts' : 1, 'search_default_current' : 1}</field>
            <field name="search_view_id" ref="view_account_analytic_account_overdue_search"/>
            <field name="help">You will find here the contracts to be renewed because the deadline is passed or the working hours are higher than the allocated hours. OpenERP automatically sets these analytic accounts to the pending state, in order to raise a warning during the timesheets recording. Salesmen should review all pending accounts and reopen or close the according to the negotiation with the customer.</field>
        </record>

        <menuitem action="action_account_analytic_overdue" id="menu_action_account_analytic_overdue" sequence="50" parent="sale.menu_invoiced" groups="base.group_extended"/>

    </data>
</openerp>
