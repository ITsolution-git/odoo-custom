(function(){var C,D;var B;scheduler.config.collision_limit=1;scheduler.attachEvent("onBeforeDrag",function(I){var H=scheduler._props?scheduler._props[this._mode]:null;var F=scheduler.matrix?scheduler.matrix[this._mode]:null;var G=H||F;if(H){var E=G.map_to}if(F){var E=G.y_property}if((G)&&I){C=this.getEvent(I)[E];D=this.getEvent(I).start_date}return true});scheduler.attachEvent("onBeforeLightbox",function(F){var E=scheduler.getEvent(F);B=[E.start_date,E.end_date];return true});scheduler.attachEvent("onEventChanged",function(F){if(!F){return true}var E=scheduler.getEvent(F);if(!A(E)){if(!B){return false}E.start_date=B[0];E.end_date=B[1];E._timed=this.is_one_day_event(E)}return true});scheduler.attachEvent("onBeforeEventChanged",function(E,F,G){return A(E)});scheduler.attachEvent("onEventSave",function(F,E){if(E.rec_type){scheduler._roll_back_dates(E)}return A(E)});function A(N){var Q=[];if(N.rec_type){var F=scheduler.getRecDates(N);for(var I=0;I<F.length;I++){var M=scheduler.getEvents(F[I].start_date,F[I].end_date);for(var J=0;J<M.length;J++){if((M[J].event_pid||M[J].id)!=N.id){Q.push(M[J])}}}Q.push(N)}else{Q=scheduler.getEvents(N.start_date,N.end_date)}var E=scheduler._props?scheduler._props[scheduler._mode]:null;var O=scheduler.matrix?scheduler.matrix[scheduler._mode]:null;var H=E||O;if(E){var G=H.map_to}if(O){var G=H.y_property}var P=true;if(H){var L=0;for(var K=0;K<Q.length;K++){if(Q[K][G]==N[G]){L++}}if(L>scheduler.config.collision_limit){scheduler._drag_event.start_date=D;N[G]=C;P=false}}else{if(Q.length>scheduler.config.collision_limit){P=false}}if(!P){return !scheduler.callEvent("onEventCollision",[N,Q])}return P}})();