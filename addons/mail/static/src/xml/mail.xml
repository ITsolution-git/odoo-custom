<?xml version="1.0" encoding="UTF-8"?>
<template>

    <!-- 
        wall main template
        Template used to display the communication history in the
        wall.
        -->
    <div t-name="mail.wall" class="oe_mail_wall">
        <table class="oe_view_manager_header">
            <tr class="oe_header_row">
                <td><h2 class="oe_view_title">All Feeds</h2></td>
                <td><div class="oe_view_manager_view_search" t-opentag="true"/></td>
            </tr>
        </table>
        <div class="oe_mail_wall_main">
            <div class="oe_mail_wall_act">
                <img class="oe_mail_msg_image oe_left" alt="User img"/>
                <textarea class="oe_mail oe_mail_wall_action_textarea" placeholder="What are you working on?"/>
                <button class="oe_right oe_mail_wall_button_comment" type="button">Post comment</button>
            </div>
            <div class="oe_clear"/>
            <div class="oe_mail_wall_threads">
                <!-- contains threads -->
            </div>
            <div class="oe_mail_wall_more">
                <button class="oe_mail_wall_button_more" type="button">See more discussions</button>
            </div>
        </div>
        <div class="oe_mail_wall_aside">
                <!-- contains currently nothing -->
        </div>
    </div>

    <!--
        thread_container template for the wall
        Each discussion thread is be contained inside this template
        -->
    <t t-name="mail.wall.thread_container">
    </t>

    <!--
        record_thread main template
        Template used to display the communciation history in documents
        form view.
        -->
    <div t-name="mail.record_thread" class="oe_mail_recthread">
        <h4>History and Comments</h4>
        <div class="oe_mail_recthread_main">
            <!-- contains the document thread -->
        </div>
        <div class="oe_mail_recthread_aside">
            <div class="oe_mail_recthread_actions">
                <button type="button" class="oe_mail_button_follow oe_mail_button_mouseout">Not following</button>
                <button type="button" class="oe_mail_button_unfollow oe_mail_button_mouseout">Following</button>
                <button type="button" class="oe_mail_button_followers">Show followers</button>
            </div>
            <div class="oe_mail_recthread_followers">
                <h4>Followers</h4>
                <ul class="oe_mail_followers_display"></ul>
            </div>
        </div>
    </div>

    <!--
        record_thread.record_thread template
        Template used to display subscibers
        -->
    <li t-name="mail.record_thread.subscriber">
        <img class="oe_mail_oe_left oe_mail_msg_image" t-attf-src="{record.avatar_url}"/>
        <a href="#" class="oe_mail_oe_intlink" data-res-model="res.users" t-attf-data-res-id="{record.id}"><t t-raw="record.name"/></a>
    </li>

    <!--
        compose_message template
        This template holds the composition form to write a note or send
        an e-mail.
        -->
    <t t-name="mail.compose_message">
        <div>
            <img class="oe_mail_msg_image oe_left" alt="User img"/>
            <div class="oe_mail_msg_content">
                <!-- contains the composition form -->
            </div>
            <div class="oe_clear"/>
        </div>
    </t>

    <ul t-name="Thread" class="oe_mail oe_mail_thread">
        <div class="oe_mail_thread_act"></div>
        <div class="oe_mail_thread_display"></div>
        <div class="oe_mail_thread_more">
            <button class="oe_mail_button_more" type="button">Load more messages</button>
        </div>
    </ul>

    <li t-name="ThreadMsg" t-attf-class="oe_mail oe_mail_thread_msg">
        <div t-attf-class="oe_mail_msg_#{record.type}">
            <img class="oe_mail_msg_menu_icon" src="/mail/static/src/img/wheel_menu.png" alt="menu"/>
            <ul class="oe_mail_msg_menu">
                <t t-if="display['show_delete']"><t t-if="thread._is_author(record.user_id[0])">
                    <li><a href="#" class="oe_mail_msg_delete" t-attf-data-id='{record.id}'>Delete</a></li>
                </t></t>
                <t t-if="display['show_hide']">
                    <li><a href="#" class="oe_mail_msg_hide" t-attf-data-id='{record.id}'>Remove from Wall</a></li>
                    <li><a href="#" class="oe_mail_msg_hide_type" t-attf-data-subtype='{record.subtype}'>Hide '<t t-esc="record.subtype"/>' for this document</a></li>
                </t>
            </ul>
            <img t-if="record.type == 'email'" class="oe_email_icon oe_left" src="/mail/static/src/img/email_icon.png"/>
            <img t-if="record.type == 'notification' || record.type == 'comment'" class="oe_mail_msg_image oe_left" t-att-src="record.mini_url"/>
            <div class="oe_mail_msg_content">
                <t t-if="record.type == 'email'"><t t-call="EmailDisplay"/></t>
                <t t-if="record.type == 'notification' || record.type == 'comment'"><t t-call="NoteDisplay"/></t>
            </div>
            <t t-if="record.type == 'tmp'"><t t-call="ThreadDisplay" /></t>
        </div>
    </li>
    
    <t t-name="NoteDisplay">
        <p class="oe_mail_msg">
            <t t-if="params.thread_level > 0">
                <a href="#" class="oe_mail_oe_intlink" t-attf-data-res-model='{params.res_model}' t-attf-data-res-id='{params.res_id}'><t t-raw="record.record_name"/></a>
            </t>
            <span class="oe_mail_msg_body"><t t-raw="record.body"/></span>
            <t t-call="MessageDisplayManageLinks"/>
        </p>
    </t>
    
    <t t-name="EmailDisplay">
        <p class="oe_mail_msg oe_mail_msg_p_email_header">
            <t t-if="params.thread_level > 0">
                <a href="#" class="oe_mail_oe_intlink" t-attf-data-res-model='{params.res_model}' t-attf-data-res-id='{params.res_id}'><t t-raw="record.record_name"/></a>
            </t>
        </p>
        <p><span class="oe_mail_oe_bold">From:</span> <t t-esc="record.email_from"/></p>
        <p><span class="oe_mail_oe_bold">Subject:</span> <t t-esc="record.subject"/></p>
        <p class="oe_mail_msg">
            <span class="oe_mail_msg_body"><t t-raw="record.body"/></span>
            <t t-call="MessageDisplayManageLinks"/>
        </p>
    </t>

    <t t-name="MessageDisplayManageLinks">
        <ul>
            <t t-if="display['show_reply']">
                <li>
                    <a href="#" class="oe_mail_msg_reply">Reply</a>
                    <span class="oe_mail_oe_space oe_fade"> 路 </span>
                </li>
            </t>
            <t t-if="display['show_delete']"><t t-if="thread._is_author(record.user_id[0])">
                <li>
                    <a href="#" t-attf-data-id='{record.id}' class="oe_mail_msg_delete">Delete</a>
                    <span class="oe_mail_oe_space oe_fade"> 路 </span>
                </li>
            </t></t>
            <t t-if="display['show_hide']">
                <li>
                    <a href="#" t-attf-data-id='{record.id}' class="oe_mail_msg_hide">Remove from Wall</a>
                    <span class="oe_mail_oe_space oe_fade"> 路 </span>
                </li>
            </t>
            <t t-if="display['show_reply_by_email']"><t t-if="record.type == 'email'">
                <li>
                    <a href="#" t-attf-data-id='{record.id}' class="oe_mail_msg_reply_by_email">Reply by e-mail</a>
                    <span class="oe_mail_oe_space oe_fade"> 路 </span>
                </li>
            </t></t>
            <li>
                <span class="oe_fade"><t t-raw="record.date"/>
                <t t-if="record.type != 'email'">
                    by <a href="#" class="oe_mail_oe_intlink" data-res-model='res.users' t-attf-data-res-id='{record.user_id[0]}'><t t-raw="record.user_id[1]"/></a>
                </t>
                </span>
            </li>
        </ul>
    </t>

</template>
