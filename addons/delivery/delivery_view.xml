<openerp>
    <data>
        <!-- Delivery Carriers -->
        <menuitem id="menu_delivery" name="Delivery" parent="stock.menu_stock_configuration" groups="base.group_no_one" sequence="50"/>

        <record id="view_delivery_carrier_tree" model="ir.ui.view">
            <field name="name">delivery.carrier.tree</field>
            <field name="model">delivery.carrier</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Carrier">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="price" invisible="'order_id' not in context"/>
                </tree>
            </field>
        </record>
        <record id="view_delivery_carrier_form" model="ir.ui.view">
            <field name="name">delivery.carrier.form</field>
            <field name="model">delivery.carrier</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Carrier" version="7.0">
                    <group col="4" name="general">
                        <field name="name"/>
                        <field name="partner_id"/>
                        <field name="product_id"/>
                        <field name="active"/>
                        <separator string="Pricing Information" colspan="4"/>
                        <group colspan="4" col="4">
                            <field name="normal_price" attrs="{'readonly':[('use_detailed_pricelist', '=', True)]}"/>
                            <newline/>
                            <field name="free_if_more_than" attrs="{'readonly':[('use_detailed_pricelist', '=', True)]}"/>
                            <field name="amount" attrs="{'required':[('free_if_more_than','&lt;&gt;',False)], 'invisible':[('free_if_more_than','=',False)]}"/>
                        </group>
                        <newline/>
                        <field name="use_detailed_pricelist"/>
                    </group>
                    <field name="pricelist_ids" attrs="{'invisible':[('use_detailed_pricelist','=',False)]}" mode="tree,form">
                         <tree string="Delivery grids">
                              <field name="sequence"/>
                              <field name="name"/>
                         </tree>
                        <form string="Delivery grids" version="7.0">
                             <group col="4">
                                 <field name="name"/>
                                 <field name="active"/>
                                 <field name="sequence"/>
                             </group>
                             <notebook>
                               <page string="Grid definition">
                                  <field name="line_ids"/>
                               </page>
                               <page string="Destination">
                                   <group string="Countries">
                                       <field colspan="2" name="country_ids" nolabel="1"/>
                                   </group>
                                   <group string="States">
                                       <field colspan="2" name="state_ids" nolabel="1"/>
                                   </group>
                                   <group col="4">
                                       <field name="zip_from"/>
                                       <field name="zip_to"/>
                                   </group>
                               </page>
                             </notebook>
                       </form>
                   </field>
                </form>
            </field>
        </record>
        <record id="action_delivery_carrier_form" model="ir.actions.act_window">
            <field name="name">Delivery Method</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">delivery.carrier</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help">Define the delivery methods you are using and their pricing in order to reinvoice the delivery costs when you are doing invoicing based on delivery orders</field>
        </record>

        <menuitem action="action_delivery_carrier_form" id="menu_action_delivery_carrier_form" parent="stock.menu_stock_configuration" sequence="15"/>

        <!-- Delivery Grids -->
        <record id="view_delivery_grid_tree" model="ir.ui.view">
            <field name="name">delivery.grid.tree</field>
            <field name="model">delivery.grid</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Delivery grids">
                    <field name="sequence"/>
                    <field name="carrier_id"/>
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="view_delivery_grid_form" model="ir.ui.view">
            <field name="name">delivery.grid.form</field>
            <field name="model">delivery.grid</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Delivery grids" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="active"/>
                        <field name="carrier_id"/>
                        <field name="sequence"/>
                    </group>
                    <notebook>
                        <page string="Grid definition">
                            <field name="line_ids"/>
                        </page>
                        <page string="Destination">
                            <group string="Countries">
                                <field name="country_ids"/>
                            </group>
                            <group string="States">
                                <field colspan="2" name="state_ids" nolabel="1"/>
                                <field name="zip_from"/>
                                <field name="zip_to"/>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="action_delivery_grid_form" model="ir.actions.act_window">
            <field name="name">Delivery Pricelist</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">delivery.grid</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="help">The delivery price list allows you to compute the cost and sales price of the delivery according to the weight of the products and other criteria. You can define several price lists for one delivery method, per country or a zone in a specific country defined by a postal code range.</field>
        </record>
        <menuitem action="action_delivery_grid_form" id="menu_action_delivery_grid_form" parent="menu_delivery"/>

        <record id="view_delivery_grid_line_form" model="ir.ui.view">
            <field name="name">delivery.grid.line.form</field>
            <field name="model">delivery.grid.line</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Grid Lines" version="7.0">
                    <field colspan="4" name="name"/>
                    <div>
                        <label string="condition" for="type"/>
                        <field name="type" class="oe_form_inline"/>
                        <field name="operator" class="oe_form_inline"/>
                        <field name="max_value" class="oe_form_inline"/>
                    </div>
                    <group col="4">
                        <field name="list_price"/>
                        <field name="standard_price"/>
                        <field name="price_type"/>
                        <field name="variable_factor" attrs="{'invisible':[('price_type','=','fixed')]}"/>
                    </group>
                </form>
            </field>
        </record>
        <record id="view_delivery_grid_line_tree" model="ir.ui.view">
            <field name="name">delivery.grid.line.tree</field>
            <field name="model">delivery.grid.line</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Grid Lines">
                    <field name="name"/>
                    <field name="type"/>
                    <field name="operator"/>
                    <field name="max_value" nolabel="1"/>
                    <field name="list_price"/>
                    <field name="standard_price"/>
                </tree>
            </field>
        </record>

        <record id="view_picking_withcarrier_out_form" model="ir.ui.view">
            <field name="name">delivery.stock.picking_withcarrier.out.form.view</field>
            <field name="type">form</field>
            <field name="model">stock.picking.out</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="carrier_id"/>
                    <field name="carrier_tracking_ref"/>
                    <field name="number_of_packages"/>
                </field>
            </field>
        </record>

        <record id="view_picking_withweight_internal_form" model="ir.ui.view">
            <field name="name">stock.picking_withweight.internal.form.view</field>
            <field name="type">form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <field name="type" position="after">
                    <field name="weight"/>
                    <field name="weight_net"/>
                </field>
            </field>
        </record>

        <record id="action_picking_tree4" model="ir.actions.act_window">
            <field name="name">Picking to be invoiced</field>
            <field name="res_model">stock.picking.out</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('invoice_state','=','2binvoiced'),('state','=','done'),('type','=','out')]</field>
            <field name="filter" eval="True"/>
            <field name="context">{'default_invoice_state': '2binvoiced', 'default_type': 'out', 'contact_display': 'partner'}</field>
            <field name="search_view_id" ref="stock.view_picking_out_search"/>
        </record>

        <record id="view_picking_withweight_internal_move_form" model="ir.ui.view">
            <field name="name">stock.picking_withweight.internal.move.form.view</field>
            <field name="type">form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <xpath expr="/form/sheet/notebook/page/field[@name='move_lines']/tree/field[@name='product_uom']" position="after">
                    <field name="weight"/>
                    <field name="weight_net"/>
                </xpath>
            </field>
        </record>

        <record id="view_move_withweight_form" model="ir.ui.view">
            <field name="name">stock.move.form.weight</field>
            <field name="type">form</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_form"/>
            <field name="arch" type="xml">
                <group colspan="2" col="2" position="after">
                    <group colspan="2" col="2">
                        <separator string="Weights" colspan="2"/>
                        <field name="weight"/>
                        <field name="weight_net"/>
                    </group>
                </group>
            </field>
        </record>

        <record id="view_move_reception_picking_withweight_form" model="ir.ui.view">
            <field name="name">stock.move.reception.packing.form.weight</field>
            <field name="type">form</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_form_reception_picking"/>
            <field name="arch" type="xml">
                <group colspan="2" col="2" position="after">
                    <group colspan="2" col="2">
                        <separator string="Weights" colspan="2"/>
                        <field name="weight"/>
                        <field name="weight_net"/>
                    </group>
                </group>
            </field>
        </record>

        <record id="view_order_withcarrier_form" model="ir.ui.view">
            <field name="name">delivery.sale.order_withcarrier.form.view</field>
            <field name="type">form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//group[@name='sale_total']" position="after">
                    <group>
                        <label for="carrier_id"/>
                        <div>
                            <field name="carrier_id" context="{'order_id':active_id or False}" class="oe_form_inline"/>
                            <button name="delivery_set" states="draft" string="Add to Sale Order" type="object"/>
                        </div>
                        <label string="If you do not 'Add to Sale Order', the delivery charges will be added based on the delivery order."/>
                    </group>
                </xpath>
            </field>
        </record>

        <record id="view_delivery_order_inherit_stock" model="ir.ui.view">
            <field name="name">stock.picking.out.form</field>
            <field name="type">form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_out_form"/>
            <field name="arch" type="xml">
                <xpath expr="/form/header/button[@string='Create Invoice']" position="after">
                    <button name="%(report_shipping)d" string="Delivery Order" states="done" type="action" icon="gtk-print"/>
                </xpath>
            </field>
        </record>

    </data>
</openerp>
