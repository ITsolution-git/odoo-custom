- |
  For customer or partner purpose, I called to him/her for discussion about openerp.
  As the success of phonecall seems to be a real business opportunity, It will convert
  it to opportunity.
-
  !record {model: crm.phonecall2opportunity, id: crm_phonecall2opportunity_disc_openerp}:
    name: Discuss Review Process
    partner_id: base.res_partner_tinyatwork
    planned_revenue: 0.0
    probability: 0.0
- |
  Business opportunity is now assigned to this phonecall.
-
  !assert {model: crm.phonecall, id: crm_case_phone04}:
     - opportunity_id != False
-
  Succeed phonecall, it will be convert into on opportunity.
-
  !python {model: crm.phonecall2opportunity}: |
    self.action_apply(cr, uid, [ref("crm_phonecall2opportunity_disc_openerp")], {"active_id": ref("crm_case_phone04")})
- |
  For business And I check that the phonecall and the newly created business 
  opportunity is linked to same  partner.
-
  !python {model: crm.phonecall}: |
    obj_phonecall = self.browse(cr, uid, ref('crm_case_phone04'))
    ids = self.pool.get('crm.lead').search(cr, uid, [('name', '=', obj_phonecall.opportunity_id.name)])
    obj_opp = self.pool.get('crm.lead').browse(cr, uid, ids)[0]
    assert obj_phonecall.partner_id == obj_opp.partner_id, "created business opportunity is not linked to same  partner"
-
  Completion of phonecall, Cheking for phonecall summary is close or not.
-
  !assert {model: crm.phonecall, id: crm.crm_case_phone04, string: phonecall is held}:
    - state == 'done'
