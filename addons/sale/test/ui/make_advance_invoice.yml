-
  In order to test the pay invoices in advance wizard of sale module in the OpenERP,
  I take a Sale order and create invoice.
-
  I create a record to pay advance invoice.
-
  !record {model: sale.advance.payment.inv, id: sale_make_invoice_adv}:
    product_id: product.product_product_pc1
    amount: 100.0
-
  Then I click on the "Advance Invoices" button.
-
  !python {model: sale.advance.payment.inv}: |
    context = {"lang": 'en_US', "search_default_user_id":1, "tz": False, "active_model": 'sale.order', "active_ids": [ref("order5")], "active_id":ref("order5")}
    self.create_invoices(cr, uid, [ref("sale_make_invoice_adv")], context)
    self.pool.get('sale.open.invoice').open_invoice(cr, uid, [ref("sale_make_invoice_adv")], context)
-
  I verify that an invoice has been created.
-
  !python {model: sale.order}: |
    inv = self.browse(cr, uid, ref('order5')).invoice_ids
    assert inv, "Invoices are not created"
-
  I verify that an account invoice line with origin 'SO003' is created.
-
  !python {model: sale.order}: |
    acc_inv_line = self.pool.get('account.invoice.line')
    inv = self.browse(cr, uid, ref('order5')).invoice_ids
    for line in inv:
      assert line.invoice_line, "Account invoice line not been created for order"
