-
  In order to test the sale module in the Open-ERP, I need to configure details regarding product & customer.
-
  I want to sell my mobile products to the customer with name Cleartrail
- 
  Creating an account.account.type record
- 
  !record {model: account.account.type, id: account_account_type_view0}:
    close_method: none
    code: View
    name: View
    sign: 1
    
    
- 
  Creating an account.account.type record
- 
  !record {model: account.account.type, id: account_account_type_income0}:
    close_method: unreconciled
    code: Income
    name: Income
    sign: 1
    
    
- 
  Creating an account.account.type record
- 
  !record {model: account.account.type, id: account_account_type_expense0}:
    close_method: unreconciled
    code: Expense
    name: Expense
    sign: 1
    
    
- 
  Creating an account.account.type record
- 
  !record {model: account.account.type, id: account_account_type_cash0}:
    close_method: balance
    code: Cash
    name: Cash
    sign: 1
    
    
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_minimalchart0}:
    code: '0'
    company_id: base.main_company
    currency_mode: current
    name: Minimal Chart
    parent_left: 1
    parent_right: 12
    type: view
    user_type: account_account_type_view0
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_payable1}:
    code: AP
    company_id: base.main_company
    currency_mode: current
    name: Payable
    parent_id: account_account_minimalchart0
    parent_left: 2
    parent_right: 3
    reconcile: true
    type: payable
    user_type: account_account_type_expense0
    
    
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_receivable0}:
    code: AR
    company_id: base.main_company
    currency_mode: current
    name: Receivable
    parent_id: account_account_minimalchart0
    parent_left: 4
    parent_right: 5
    reconcile: true
    type: receivable
    user_type: account_account_type_income0
    
    
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_cash0}:
    code: C
    company_id: base.main_company
    currency_mode: current
    name: Cash
    parent_id: account_account_minimalchart0
    parent_left: 6
    parent_right: 7
    type: other
    user_type: account_account_type_cash0
    
    
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_purchases0}:
    code: P
    company_id: base.main_company
    currency_mode: current
    name: Purchases
    parent_id: account_account_minimalchart0
    parent_left: 8
    parent_right: 9
    type: other
    user_type: account_account_type_expense0
- 
  Creating an account.account record
- 
  !record {model: account.account, id: account_account_sales0}:
    code: S
    company_id: base.main_company
    currency_mode: current
    name: Sales
    parent_id: account_account_minimalchart0
    parent_left: 10
    parent_right: 11
    type: other
    user_type: account_account_type_income0

    
- 
  Creating an account.journal record
- 
  !record {model: account.journal, id: account_journal_purchasejournal0}:
    code: PUJ
    company_id: base.main_company
    default_credit_account_id: account_account_purchases0
    default_debit_account_id: account_account_purchases0
    name: Purchase Journal
    sequence_id: account.sequence_purchase_journal
    type: purchase
    view_id: account.account_journal_view
    
    
- 
  Creating an account.journal record
- 
  !record {model: account.journal, id: account_journal_salejournal0}:
    code: SAJ
    company_id: base.main_company
    default_credit_account_id: account_account_sales0
    default_debit_account_id: account_account_sales0
    name: Sale Journal
    sequence_id: account.sequence_sale_journal
    type: sale
    view_id: account.account_journal_view
    
    
- 
  Creating an account.journal record
- 
  !record {model: account.journal, id: account_journal_bankjournal0}:
    code: BNK
    company_id: base.main_company
    default_credit_account_id: account_account_cash0
    default_debit_account_id: account_account_cash0
    name: Bank Journal
    sequence_id: account.sequence_journal
    type: cash
    view_id: account.account_journal_bank_view
    
    
- 
  Creating a ir.property record
- 
  !record {model: ir.property, id: ir_property_propertyaccountexpensecateg0}:
    company_id: base.main_company
    fields_id: account.field_res_partner_property_account_payable
    name: property_account_expense_categ
    value_reference: account.account,5
    
    
- 
  Creating a ir.property record
- 
  !record {model: ir.property, id: ir_property_propertyaccountincomecateg0}:
    company_id: base.main_company
    fields_id: account.field_res_partner_property_account_receivable
    name: property_account_income_categ
    value_reference: account.account,6
- 
  Creating a res.partner.category record
- 
  !record {model: res.partner.category, id: res_partner_category_customers0}:
    name: Customers
-
  Creating an res.partner record
- 
  !record {model: res.partner, id: res_partner_cleartrail0}:
    category_id:
      - res_partner_category_customers0
    name: Cleartrail
    
    
- 
  Creating an res.partner.address record
- 
  !record {model: res.partner.address, id: res_partner_address_1}:
    partner_id: res_partner_cleartrail0
    street: onam plaza, 14 B palasia A B Road
    type: contact
    
    
- 
  Creating an res.partner.address record
- 
  !record {model: res.partner.address, id: res_partner_address_2}:
    partner_id: res_partner_cleartrail0
    type: invoice
    
    
- 
  Creating an res.partner.address record
- 
  !record {model: res.partner.address, id: res_partner_address_3}:
    partner_id: res_partner_cleartrail0
    street: sangam house 15 B palasia, A B Road
    type: delivery
-
  Customer Cleartrail has specific instrument requirements regarding the stockable products
- 
  Creating an product.category record
- 
  !record {model: product.category, id: product_category_allproductssellable0}:
    name: Mobile Products Sellable
    
    
- 
  Creating an product.category record
- 
  !record {model: product.category, id: product_category_services0}:
    name: Mobile Services
- 
  Creating an product.template record
- 
  !record {model: product.template, id: product_template_newchocolateslidermobile0}:
    categ_id: product_category_allproductssellable0
    cost_method: standard
    list_price: 200.0
    mes_type: fixed
    name: New Chocolate Slider Mobile
    procure_method: make_to_order
    standard_price: 189.0
    supply_method: buy
    type: product
    uom_id: product.product_uom_unit
    uom_po_id: product.product_uom_unit
   
- 
  Creating an product.product record
- 
  !record {model: product.product, id: product_product_newchocolateslidermobile0}:
    categ_id: product_category_allproductssellable0
    cost_method: standard
    list_price: 200.0
    mes_type: fixed
    name: New Chocolate Slider Mobile
    pricelist_purchase: 'Default Purchase Pricelist (0.00) : 189.00\n'
    pricelist_sale: 'Public Pricelist (0.00) : 200.00\n'
    procure_method: make_to_order
    property_account_expense: sale.account_account_payable1
    property_account_income: sale.account_account_receivable0
    seller_delay: '1'
    standard_price: 189.0
    supply_method: buy
    type: product
    uom_id: product.product_uom_unit
    uom_po_id: product.product_uom_unit
    

- 
  Creating a sale.order record
-
  !record {model: sale.order, id: sale_order_so0}:
    date_order: '2010-05-12'
    invoice_quantity: order
    name: Test_SO002
    order_line:
      - name: New Chocolate Slider Mobile
        price_unit: 200.0
        product_uom: product.product_uom_unit
        product_uom_qty: 500.0
        state: draft
        delay: 7.0
        product_id: sale.product_product_newchocolateslidermobile0
        product_uos_qty: 500.0
        type: make_to_order
    order_policy: manual
    partner_id: sale.res_partner_cleartrail0
    partner_invoice_id: sale.res_partner_address_2
    partner_order_id: sale.res_partner_address_1
    partner_shipping_id: sale.res_partner_address_3
    picking_policy: direct
    pricelist_id: product.list0
    shop_id: sale.shop
- 
  Performing a workflow action order_confirm on module sale.order
- 
  !workflow {model: sale.order, action: order_confirm, ref: sale_order_so0}
-
  I click on Create Invoice button to create the invoice.
-
  Performing a workflow action manual_invoice on module sale.order
- 
  !workflow {model: sale.order, action: manual_invoice, ref: sale_order_so0}
-
  I verify whether the invoice has been generated for SO
-
  !python {model: sale.order}: |
    so = self.browse(cr, uid, ref("sale_order_so0"))
    assert so.invoice_ids, "Invoices has not been generated for sale_order_so0"
- 
  Performing a workflow action invoice_open on module account.invoice
- 
  !python {model: account.invoice}: |
    sale_order_obj = self.pool.get('sale.order')
    so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))
    import netsvc
    wf_service = netsvc.LocalService("workflow")  
    invoice_ids = so.invoice_ids
    for invoice in invoice_ids:
      wf_service.trg_validate(uid, 'account.invoice',invoice.id,'invoice_open', cr) 
-
  Creating a account.invoice.pay record
- 
  !record {model: account.invoice.pay, id: account_invoice_pay_tst0}:
    amount: 100000.0
    date: '2010-05-10'
    journal_id: sale.account_journal_bankjournal0
    name: test
    period_id: account.period_5
- 
  Performing an osv_memory action wo_check on module account.invoice.pay
- 
  !python {model: account.invoice.pay}: |
    sale_order_obj = self.pool.get('sale.order')
    so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))  
    self.wo_check(cr, uid, [ref("account_invoice_pay_tst0")], {"lang": "en_US", "tz":
      False, "active_model": 'account.invoice', "active_ids": [so.invoice_ids[0].id], "type":
      "out_invoice", "active_id": so.invoice_ids[0].id})
    
    
- 
  Creating a account.invoice.pay.writeoff record
- 
  !record {model: account.invoice.pay.writeoff, id: account_invoice_pay_writeoff_0}:
    analytic_id: account.analytic_customers
    comment: Write-Off
    writeoff_acc_id: account.a_sale
    writeoff_journal_id: sale.account_journal_bankjournal0
    
    
- 
  Performing an osv_memory action pay_and_reconcile_writeoff on module account.invoice.pay.writeoff
- 
  !python {model: account.invoice.pay.writeoff}: |
    sale_order_obj = self.pool.get('sale.order')
    so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))   
    self.pay_and_reconcile_writeoff(cr, uid, [ref("account_invoice_pay_writeoff_0")],
      {"lang": 'en_US', "tz": False, "active_model": 'account.invoice', "active_ids":
      [so.invoice_ids[0].id], "type": "out_invoice", "active_id": so.invoice_ids[0].id, })
-
  I verify the invoice are in paid state or not. 
-
  !python {model: account.invoice}: |
    sale_order_obj = self.pool.get('sale.order')
    so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))
    invoice_ids = so.invoice_ids
    for invoice in invoice_ids:
        assert (invoice.state) =='paid', "Invoice for SO is not in done state."
- 
  I will verify the picking associated with the sale order sale_order_so0
- 
  !python {model: sale.order}: |
    so = self.browse(cr, uid, ref("sale_order_so0"))
    assert so.picking_ids,"Picking has not been generated for sale_order_so0"
-
  Creating a stock.partial.picking record
- 
  !python {model: stock.picking }: |
   import time
   sale_order_obj = self.pool.get('sale.order')
   so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))
   picking_id = self.search(cr, uid, [('origin','=',so.name),('type','=','out')])
   if picking_id:
      pick=self.browse(cr,uid,picking_id[0])
      pick.force_assign(cr, uid)
      partial_datas = {
           'partner_id':pick.address_id.partner_id.id,
            'address_id': pick.address_id.id,
            'delivery_date' : time.strftime('%Y-%m-%d'),
           }
      move = pick.move_lines[0]
      partial_datas['move%s'%(move.id)]= {
          'product_id': move.product_id.id,
          'product_qty': move.product_qty,
          'product_uom': move.product_uom.id,
      } 
      self.do_partial(cr, uid, picking_id,partial_datas)
-
  I verify that picking order is in done state
-
  !python {model: stock.picking }: |
   sale_order_obj = self.pool.get('sale.order')
   so = sale_order_obj.browse(cr, uid, ref("sale_order_so0"))
   picking_id = self.search(cr, uid, [('origin','=',so.name),('type','=','out')])
   if picking_id:
     pick = self.browse(cr,uid,picking_id[0])
     assert (pick.state) =='done', "Picking for SO is not in done state." 
