<openerp>
    <data>
        <menuitem icon="terp-partner" id="base.menu_base_partner" name="Sales" sequence="1" groups="base.group_sale_salesman,base.group_sale_manager"/>
        <menuitem id="base.menu_product" name="Products" parent="base.menu_base_partner" sequence="9"/>


        <record id="view_shop_form" model="ir.ui.view">
            <field name="name">sale.shop</field>
            <field name="model">sale.shop</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Sales Shop" version="7.0">
                    <label for="name" class="oe_edit_only"/>
                    <h1><field name="name"/></h1>
                    <group>
                        <group>
                            <field name="warehouse_id" required="1" widget="selection"/>
                            <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                        </group>
                        <group>
                            <field name="payment_default_id"/>
                            <field domain="[('type','=','sale')]" name="pricelist_id" groups="product.group_sale_pricelist"/>
                            <field name="project_id" groups="analytic.group_analytic_accounting"/>
                        </group>
                    </group>
                </form>
            </field>
        </record>
        <record id="view_shop_tree" model="ir.ui.view">
            <field name="name">sale.shop</field>
            <field name="model">sale.shop</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Sales Shop">
                    <field name="name"/>
                    <field name="warehouse_id"/>
                    <field name="pricelist_id" groups="product.group_sale_pricelist"/>
                    <field name="project_id" groups="analytic.group_analytic_accounting"/>
                </tree>
            </field>
        </record>

        <record id="action_shop_form" model="ir.actions.act_window">
            <field name="name">Shop</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.shop</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_shop_tree"/>
            <field name="help">If you have more than one shop reselling your company products, you can create and manage that from here. Whenever you will record a new quotation or sales order, it has to be linked to a shop. The shop also defines the warehouse from which the products will be delivered for each particular sales.</field>
        </record>

        <menuitem action="action_shop_form" id="menu_action_shop_form" parent="base.menu_base_config" sequence="35"
            groups="stock.group_locations"/>

        <record id="view_sale_order_calendar" model="ir.ui.view">
            <field name="name">sale.order.calendar</field>
            <field name="model">sale.order</field>
            <field name="type">calendar</field>
            <field name="arch" type="xml">
                <calendar string="Sales Orders" color="state" date_start="date_order">
                    <field name="partner_id"/>
                    <field name="amount_total"/>
                </calendar>
            </field>
        </record>
        <record model="ir.ui.view" id="view_sale_order_graph">
            <field name="name">sale.order.graph</field>
            <field name="model">sale.order</field>
            <field name="type">graph</field>
            <field name="arch" type="xml">
                <graph string="Sales Orders" type="bar">
                    <field name="partner_id"/>
                    <field name="amount_total" operator="+"/>
                </graph>
            </field>
        </record>

        <record id="view_order_tree" model="ir.ui.view">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="type">tree</field>
            <field name="priority">2</field>
            <field name="arch" type="xml">
                <tree string="Sales Orders" fonts="bold:needaction_pending==True" colors="grey:state=='cancel';blue:state in ('waiting_date','manual');red:state in ('invoice_except','shipping_except')">
                    <field name="needaction_pending" invisible="1"/>
                    <field name="name"/>
                    <field name="date_order"/>
                    <field name="partner_id"/>
                    <field name="user_id"/>
                    <field name="picked_rate" widget="progressbar"/>
                    <field name="invoiced_rate" widget="progressbar"/>
                    <field name="amount_total" sum="Total Tax Included"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_order_form" model="ir.ui.view">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Sales Order" version="7.0">
                    <header>
                        <span groups="base.group_user">
                            <button name="invoice_recreate" states="invoice_except" string="Recreate Invoice"/>
                            <button name="invoice_corrected" states="invoice_except" string="Ignore Exception"/>
                            <button name="ship_recreate" states="shipping_except" string="Recreate Delivery Order"/>
                            <button name="ship_corrected" states="shipping_except" string="Ignore Exception"/>
                            <button name="action_quotation_send" string="Send by Mail" type="object" states="draft" class="oe_highlight"/>
                            <button name="action_quotation_send" string="Send by Mail" type="object" states="sent"/>
                            <button name="manual_invoice" states="manual" string="Create Final Invoice" type="object" class="oe_highlight"/>
                            <button name="print_quotation" string="Send by Post" type="object" states="draft" class="oe_highlight"/>
                            <button name="print_quotation" string="Send by Post" type="object" states="sent"/>
                            <button name="action_button_confirm" states="draft" string="Confirm" type="object"/>
                            <button name="action_button_confirm" states="sent" string="Confirm" class="oe_highlight" type="object"/>
                            <button name="action_view_invoice" string="Open Invoice" type="object" 
                              attrs="{'invisible': ['|','|',('state', '!=','progress'), ('invoiced', '=', True),('order_policy','=','picking')]}"/>
                            <button name="action_view_delivery" string="Open Delivery Order" type="object" 
                              attrs="{'invisible': ['|','|','|',('picking_ids','=',False),('picking_ids','=',[]), ('state', 'not in', ('progress','manual')),('shipped','=',True)]}"/>
                            <button name="%(action_view_sale_advance_payment_inv)d" string="Advance Invoice" type="action" states="manual"/>
                            <button name="cancel" states="draft,sent" string="Cancel"/>
                            <button name="action_cancel" states="manual,progress" string="Cancel" type="object"/>
                            <button name="ship_cancel" states="shipping_except" string="Cancel"/>
                            <button name="invoice_cancel" states="invoice_except" string="Cancel"/>
                        </span>
                        <field name="state" widget="statusbar" statusbar_visible="draft,sent,progress,invoiced,done" statusbar_colors='{"shipping_except":"red","invoice_except":"red","waiting_date":"blue"}'/>
                </header>
                <sheet>
                    <h1>
                        <label string="Quotation " attrs="{'invisible': [('state','not in',('draft','sent'))]}"/>
                        <label string="Sale Order " attrs="{'invisible': [('state','in',('draft','sent'))]}"/>
                        <field name="name" class="oe_inline" readonly="1"/>
                    </h1>
                    <group>
                        <group>
                            <field name="partner_id" on_change="onchange_partner_id(partner_id)" domain="[('customer','=',True)]" context="{'search_default_customer':1}"/>
                            <field domain="[('parent_id','=',partner_id)]" name="partner_invoice_id" groups="sale.group_delivery_invoice_address" options='{"quick_create": false}'/>
                            <field domain="[('parent_id','=',partner_id)]" name="partner_shipping_id" groups="sale.group_delivery_invoice_address" options='{"quick_create": false}'/>
                            <field name="project_id" context="{'partner_id':partner_id, 'pricelist_id':pricelist_id, 'default_name':name}" groups="sale.group_analytic_accounting" domain="[('parent_id','!=',False)]"/>
                        </group>
                        <group>
                            <field name="date_order"/>
                            <field name="shop_id" on_change="onchange_shop_id(shop_id)" widget="selection" groups="stock.group_locations"/>
                            <field name="client_order_ref"/>
                            <field domain="[('type','=','sale')]" name="pricelist_id" groups="product.group_sale_pricelist" on_change="onchange_pricelist_id(pricelist_id,order_line)"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Order Lines">
                            <field name="order_line">
                                <form string="Sales Order Lines" version="7.0">
                                    <header>
                                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done" statusbar_colors='{"exception":"red","cancel":"red"}'/>
                                    </header>
                                    <group col="4" colspan="4">
                                        <group>
                                            <field name="product_id"
                                                context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                                groups="base.group_user" 
                                                on_change="product_id_change(parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id, False, True, parent.date_order, product_packaging, parent.fiscal_position, False, context)"/>
                                            <field name="name" placeholder="Product/Service characteristics"/>
                                        </group>
                                        <group>
                                            <label for="product_uom_qty"/>
                                            <div>
                                                <field
                                                    context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
                                                    name="product_uom_qty" class="oe_inline"
                                                    on_change="product_id_change(parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id, False, False, parent.date_order, product_packaging, parent.fiscal_position, True, context)"/>
                                                <field name="product_uom" groups="product.group_uom" class="oe_inline"
                                                    on_change="product_uom_change(parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id, False, False, parent.date_order, context)"/>

                                            </div>
                                            <label for="product_uos_qty"/>
                                            <div>
                                                <field groups="product.group_uos" name="product_uos_qty" class="oe_inline"/>
                                                <field groups="product.group_uos" name="product_uos" class="oe_inline"/>
                                            </div>
                                            <field name="price_unit"/>
                                            <field name="discount" groups="sale.group_discount_per_so_line"/>
                                        </group>
                                    </group>
                                    <group>
                                        <group>
                                            <field name="product_packaging"
                                                context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}" on_change="product_packaging_change(parent.pricelist_id, product_id, product_uom_qty, product_uom, parent.partner_id, product_packaging, True, context)"
                                                domain="[('product_id','=',product_id)]" groups="product.group_stock_packaging"
                                                colspan="3"/>
                                            <field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
                                            <field name="invoiced"/>
                                            <button name="%(action_view_sale_order_line_make_invoice)d" states="confirmed" string="Make Invoices" type="action" icon="terp-document-new"/>
                                        </group>
                                        <group col="4">
                                            <field name="type"/>
                                            <field name="delay"/>
                                            <field name="th_weight"/>
                                            <field name="address_allotment_id"/>
                                        </group>
                                        <separator string="Properties" colspan="2"/>
                                        <field name="property_ids" colspan="4" nolabel="1"/>
                                        <field name="notes" groups="base.group_sale_notes_subtotal" placeholder="Add a note on order line..."/>
                                        <div groups="base.group_no_one">
                                            <separator colspan="4" string="Invoice Lines"/>
                                            <field colspan="4" name="invoice_lines" nolabel="1"/>
                                            <separator colspan="4" string="Stock Moves"/>
                                            <field colspan="4" name="move_ids" nolabel="1" widget="many2many"/>
                                        </div>
                                    </group>
                                </form>
                                <tree string="Sales Order Lines">
                                    <field name="sequence"/>
                                    <field name="name"/>
                                    <field name="product_uom_qty" string="Quantity"/>
                                    <field name="product_uom" string="Unit of Measure" groups="product.group_uom"/>
                                    <field groups="product.group_uos" name="product_uos_qty" string="Quantity (UoS)"/>
                                    <field groups="product.group_uos" name="product_uos" string="UoS"/>
                                    <field name="discount" groups="sale.group_discount_per_so_line"/>
                                    <field name="price_unit"/>
                                    <field name="price_subtotal" groups="base.group_sale_notes_subtotal"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                                <field name="amount_untaxed"/>
                                <field name="amount_tax"/>
                                <field name="amount_total" class="oe_subtotal_footer_separator"/>
                            </group>
                            <separator string="Notes" class="oe_clear"/>
                            <field name="note" placeholder="Add a global note on the sale order..."/>
                        </page>
                        <page string="Other Information" groups="base.group_user">
                            <group>
                                <group name="logistics">
                                    <field name="incoterm" widget="selection" groups="base.group_user"/>
                                    <field name="picking_policy" required="True"/>
                                    <field name="order_policy" on_change="shipping_policy_change(order_policy)"/>
                                    <field name="invoice_quantity" invisible="True"/>
                                </group>
                                <group groups="base.group_user">
                                    <field name="user_id"/>
                                    <field groups="base.group_no_one" name="origin"/>
                                </group>
                                <group name="sale_pay">
                                    <field name="payment_term" widget="selection"/>
                                    <field name="fiscal_position" widget="selection"/>
                                    <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                                </group>
                                <group>
                                    <field name="invoiced"/>
                                    <field name="shipped"/>
                                </group>
                            </group>
                        </page>
                        <page string="History">
                            <separator string="Invoices"/>
                            <field name="invoice_ids" context="{'form_view_ref':'account.invoice_form'}">
                                <tree string="Invoices" colors="blue:state == 'draft';black:state in ('proforma','proforma2','open');gray:state == 'cancel'">
                                    <field name="date_invoice"/>
                                    <field name="number"/>
                                    <field name="partner_id"/>
                                    <field name="user_id"/>
                                    <field name="date_due"/>
                                    <field name="amount_total"/>
                                    <field name="state"/>
                                </tree>
                            </field>
                            <separator string="Delivery Orders"/>
                            <field name="picking_ids" context="{'default_type': 'out'}">
                                <tree colors="blue:state == 'draft';grey:state == 'cancel';red:state not in ('cancel', 'done') and min_date &lt; current_date" string="Delivery Orders">
                                    <field name="name"/>
                                    <field name="partner_id" string="Customer"/>
                                    <field name="min_date"/>
                                    <field name="state"/>
                                    <button name="action_process" states="assigned" string="Deliver" type="object" icon="gtk-go-forward" context="{'default_type': 'out'}"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <field name="message_ids" widget="ThreadView"/>
                </footer>
                </form>
            </field>
        </record>

        <record id="view_sales_order_filter" model="ir.ui.view">
            <field name="name">sale.order.list.select</field>
            <field name="model">sale.order</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Sales Order">
                    <filter icon="terp-document-new" string="Quotations" name="draft" domain="[('state','in',('draft','sent'))]" help="Sales Order that haven't yet been confirmed"/>
                    <filter icon="terp-check" string="Sales" name="sales" domain="[('state','in',('manual','progress'))]"/>
                    <separator orientation="vertical"/>
                    <filter icon="terp-dolar_ok!" string="To Invoice" domain="[('state','=','manual')]" help="Sales Order ready to be invoiced"/>
                    <separator orientation="vertical"/>
                    <field name="name"
                        filter_domain="['|', ('name','ilike',self),('client_order_ref','ilike',self)]"/>
                    <field name="partner_id"/>
                    <field name="user_id">
                        <filter domain="[('user_id','=',uid)]" help="My Sale Orders" icon="terp-personal"/>
                    </field>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Customer" icon="terp-personal" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Salesperson" icon="terp-personal" domain="[]" context="{'group_by':'user_id'}"/>
                        <separator orientation="vertical"/>
                        <filter string="Status" icon="terp-stock_effects-object-colorize" domain="[]" context="{'group_by':'state'}"/>
                        <separator orientation="vertical"/>
                        <filter string="Order Date" icon="terp-go-month" domain="[]" context="{'group_by':'date_order'}"/>
                    </group>
               </search>
            </field>
        </record>

        <record id="action_order_form" model="ir.actions.act_window">
            <field name="name">Sales Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="search_view_id" ref="view_sales_order_filter"/>
            <field name="context">{"search_default_sales":1}</field>
            <field name="help">Sales Orders help you manage quotations and orders from your customers. OpenERP suggests that you start by creating a quotation. Once it is confirmed, the quotation will be converted into a Sales Order. OpenERP can handle several types of products so that a sales order may trigger tasks, delivery orders, manufacturing orders, purchases and so on. Based on the configuration of the sales order, a draft invoice will be generated so that you just have to confirm it when you want to bill your customer.</field>
        </record>
        <menuitem action="action_order_form" id="menu_sale_order" parent="base.menu_sales" sequence="4" groups="base.group_sale_salesman,base.group_sale_manager"/>

        <record id="action_order_tree2" model="ir.actions.act_window">
            <field name="name">Sales in Exception</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="domain">[('state','in',('shipping_except','invoice_except'))]</field>
            <field name="filter" eval="True"/>
            <field name="search_view_id" ref="view_sales_order_filter"/>
        </record>

        <record id="action_order_tree4" model="ir.actions.act_window">
            <field name="name">Sales Order in Progress</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="domain">[('state','in',('progress','waiting_date','manual'))]</field>
            <field name="search_view_id" ref="view_sales_order_filter"/>
        </record>


        <record id="action_order_tree5" model="ir.actions.act_window">
            <field name="name">Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="context">{"search_default_draft":1}</field>
            <field name="search_view_id" ref="view_sales_order_filter"/>
            <field name="help">
                Click here to create a new quotation.
                &lt;p&gt;
                The "Quotation" is the first step of the Sales flow.  Manage your sales from quotation to invoice.
                &lt;p&gt;
                You will be able to sell products (manage deliveries) as well as services (create projects).
            </field>
        </record>

        <menuitem id="menu_sale_quotations"
        action="action_order_tree5" parent="base.menu_sales"
        sequence="3"/>

        <record id="action_order_tree" model="ir.actions.act_window">
            <field name="name">Old Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,graph</field>
            <field name="domain">[('state','=','draft'),('date_order','&lt;',time.strftime('%Y-%m-%d %H:%M:%S'))]</field>
            <field name="filter" eval="True"/>
            <field name="search_view_id" ref="view_sales_order_filter"/>
        </record>

        <record id="view_order_line_graph" model="ir.ui.view">
            <field name="name">sale.order.line.graph</field>
            <field name="model">sale.order.line</field>
            <field name="type">graph</field>
            <field name="arch" type="xml">
                <graph string="Sales Order Lines">
                    <field name="product_id"/>
                    <field name="price_subtotal" operator="+"/>
                </graph>
            </field>
        </record>

        <record id="view_order_line_tree" model="ir.ui.view">
            <field name="name">sale.order.line.tree</field>
            <field name="model">sale.order.line</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Sales Order Lines">
                    <field name="order_id"/>
                    <field name="order_partner_id"/>
                    <field name="product_id"/>
                    <field name="product_uom_qty" string="Qty"/>
                    <field name="product_uom" string="Unit of Measure" groups="product.group_uom"/>
                    <field name="salesman_id"/>
                    <field name="price_subtotal" sum="Total" groups="base.group_sale_notes_subtotal"/>
                    <field name="state"/>
                    <field name="invoiced"/>
                </tree>
            </field>
        </record>
        <record id="view_order_line_form2" model="ir.ui.view">
            <field name="name">sale.order.line.form2</field>
            <field name="model">sale.order.line</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Sales Order Lines" version="7.0">
                    <header>
                        <span groups="base.group_user">
                            <button name="button_cancel" string="Cancel" type="object" icon="gtk-cancel" states="confirmed,exception"/>
                            <button name="%(action_view_sale_order_line_make_invoice)d" string="Create Invoice" type="action" states="done" icon="gtk-go-forward" attrs="{'invisible': [('invoiced', '=', 1)]}"/>
                            <button name="button_done" string="Done" type="object" states="confirmed,exception" icon="gtk-go-forward"/>
                        </span>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done" statusbar_colors='{"exception":"red","cancel":"red"}'/>
                    </header>
                    <sheet>
                    <label for="order_id" class="oe_edit_only"/>
                    <h1><field name="order_id"/></h1>
                    <label for="order_partner_id" class="oe_edit_only"/>
                    <h2><field name="order_partner_id"/></h2>
                    <group>
                        <group>
                            <field name="product_id" readonly="1"/>
                            <field name="name" groups="base.group_no_one"/>
                            <label name="product_uom_qty"/>
                            <div>
                                <field name="product_uom_qty" readonly="1" class="oe_inline"/>
                                <field name="product_uom" groups="product.group_uom" class="oe_inline"/>
                            </div>
                        </group>
                        <group>
                            <field name="price_unit"/>
                            <field name="discount" groups="sale.group_discount_per_so_line"/>
                            <field name="price_subtotal" groups="base.group_sale_notes_subtotal"/>
                            <field name="invoiced"/>
                            <field name="company_id" groups="base.group_multi_company" readonly="1"/>
                        </group>
                    </group>
                    <separator string="Notes" groups="base.group_sale_notes_subtotal"/>
                    <field name="notes" groups="base.group_sale_notes_subtotal"/>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_sales_order_line_filter" model="ir.ui.view">
            <field name="name">sale.order.line.select</field>
            <field name="model">sale.order.line</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Sales Order">
                    <filter icon="terp-dolar_ok!" string="To Invoice" domain="[('invoiced','&lt;&gt;', 1),('state','=','done')]"  help="Sale Order Lines ready to be invoiced"/>
                    <separator orientation="vertical"/>
                    <field name="order_id"/>
                    <field name="order_partner_id"/>
                    <field name="product_id"/>
                    <field name="salesman_id">
                        <filter icon="terp-personnal" domain="[('salesman_id','=',uid)]" help="Sales Order Lines related to a Sales Order of mine"/>
                    </field>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Product" icon="terp-accessories-archiver" domain="[]" context="{'group_by':'product_id'}"/>
                        <filter string="Order" icon="terp-gtk-jump-to-rtl" domain="[]" context="{'group_by':'order_id'}"/>
                        <filter string="Salesperson" icon="terp-personal" domain="[]" context="{'group_by':'salesman_id'}"/>
                        <filter string="Status" icon="terp-stock_effects-object-colorize" domain="[]" context="{'group_by':'state'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="view_sales_order_uninvoiced_line_filter" model="ir.ui.view">
            <field name="name">sale.order.uninvoiced.line</field>
            <field name="model">sale.order.line</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Uninvoiced Lines">
                    <filter icon="terp-gtk-go-back-rtl" string="To Do" domain="[('state','=','confirmed')]" name="sale order" help="Confirmed sale order lines, not yet delivered"/>
                    <filter icon="terp-dialog-close" string="Done" domain="[('state','=','done')]" name="sale_order_done" help="Sale order lines done"/>
                    <separator orientation="vertical"/>
                    <filter icon="terp-accessories-archiver" string="Shipped" domain="[('state','=','done')]" name="unshipped" help="Sale Order Lines that are in 'done' state"/>
                    <filter icon="terp-dolar_ok!" string="Uninvoiced" name="uninvoiced" domain="[('invoiced','&lt;&gt;', 1),('state','&lt;&gt;','draft'),('state','&lt;&gt;','cancel')]" help="Sale Order Lines that are confirmed, done or in exception state and haven't yet been invoiced"/>
                    <separator orientation="vertical"/>
                    <field name="order_id"/>
                    <field name="order_partner_id"/>
                    <field name="product_id"/>
                    <field name="salesman_id">
                        <filter icon="terp-personal" domain="[('salesman_id','=',uid)]" help="My Sales Order Lines"/>
                    </field>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Order" icon="terp-gtk-jump-to-rtl" domain="[]" context="{'group_by':'order_id'}" help="Order reference"/>
                        <filter string="Product" icon="terp-accessories-archiver" domain="[]" context="{'group_by':'product_id'}"/>
                        <separator orientation="vertical"/>
                        <filter string="Status" icon="terp-stock_effects-object-colorize" domain="[]" context="{'group_by':'state'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_order_line_tree2" model="ir.actions.act_window">
            <field name="name">Order Lines to Invoice</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="search_view_id" ref="view_sales_order_uninvoiced_line_filter"/>
            <field name="context">{"search_default_uninvoiced":1}</field>
            <field name="filter" eval="True"/>
            <field name="help">Here is a list of each sales order line to be invoiced. You can invoice sales orders partially, by lines of sales order. You do not need this list if you invoice from the delivery orders or if you invoice sales totally.</field>
        </record>

        <record id="action_order_line_tree3" model="ir.actions.act_window">
            <field name="name">Uninvoiced and Delivered Lines</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">sale.order.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="domain">[('invoiced','&lt;&gt;', 1),('state','=','done')]</field>
            <field name="filter" eval="True"/>
        </record>

        <act_window
            context="{'search_default_partner_id': active_id, 'default_partner_id': active_id}"
            id="act_res_partner_2_sale_order"
            name="Quotations and Sales"
            groups="base.group_sale_salesman"
            res_model="sale.order"
            src_model="res.partner"/>

        <act_window
            context="{'search_default_product_id': active_id, 'default_product_id': active_id}"
            id="action_order_line_product_tree"
            name="Sales Order Lines"
            res_model="sale.order.line"
            src_model="product.product"
            groups="base.group_sale_salesman"/>

        <menuitem id="base.menu_invoiced" name="Invoicing" parent="base.menu_base_partner" sequence="5"/>
        <menuitem id="menu_invoicing_sales_order_lines" parent="base.menu_invoiced" action="action_order_line_tree2" sequence="10" groups="sale.group_invoice_so_lines"/>

    </data>
</openerp>
