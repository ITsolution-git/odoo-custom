<?xml version="1.0"?>
<openerp>
    <data>

    <!--
    ================================================================
    Marketing Segments Inherited View - mailchimp
    ================================================================
    -->

    <record model="ir.ui.view" id="view_marketing_campaign_segment_form_inherit">
        <field name="name">marketing.campaign.segment.form.inherit</field>
        <field name="model">marketing.campaign.segment</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="marketing_campaign.view_marketing_campaign_segment_form"/>
        <field name="arch" type="xml">
            <field name="date_done" position="after">
                <separator string="Mailchimp Synchronization" colspan="4"/>
                <field name="synchro"/>
                <group colspan="2" attrs="{'invisible':[('synchro','!=',True)]}">
                    <field name="mailchimp_account_id" attrs="{'required':[('synchro','=',True)]}" domain="[('state','=','approved')]" on_change="onchange_mailchimp(mailchimp_account_id)"/>
                    <field name="mailchimp_list" attrs="{'required':[('synchro','=',True)]}" on_change="onchange_mailchimp_list(mailchimp_account_id,mailchimp_list)"/>
                </group>
            </field>
        </field>
    </record>


    <!--
    ================================================================
    Mailchimp Account
    ================================================================
    -->

    <menuitem name="Tools" id="base.menu_tools" icon="STOCK_PREFERENCES" sequence="15"/>
    <menuitem name="Mailchimps" id="menu_action_mailchimp" parent="base.menu_tools" />

    <record model="ir.ui.view" id="view_marketing_campaign_mailchimp_account_tree">
        <field name="name">marketing.campaign.mailchimp.account.tree</field>
        <field name="model">marketing.campaign.mailchimp.account</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="All Accounts">
                <field name="name"/>
                <field name="username" />
                <field name="password"/>
                <field name="data_center"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="view_marketing_campaign_mailchimp_account_form">
        <field name="name">marketing.campaign.mailchimp.account.form</field>
        <field name="model">marketing.campaign.mailchimp.account</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Account">
                <field name="name" select="1"/>
                <newline/>
                <field name="username" select="1"/>
                <field name="password" select="1"/>
                <field name="apikey" />
                <field name="data_center"/>
                <separator string="Status" colspan="4"/>
                <group col="13" colspan="4">
                    <field name="state" nolabel="1"/>
                    <button name="button_approve" string="Approve" states="draft" type="object"/>
                    <button name="button_cancel" string="Cancel" states="draft,approved" type="object"/>
                </group>
            </form>
        </field>
    </record>

    <record model="ir.actions.act_window" id="action_marketing_campaign_mailchimp_account">
        <field name="name">All Mailchimp Accounts</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">marketing.campaign.mailchimp.account</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_marketing_campaign_mailchimp_account_tree"/>
    </record>

    <menuitem id="menu_action_marketing_campaign_mailchimp_account" parent="menu_action_mailchimp" action="action_marketing_campaign_mailchimp_account" sequence="40"/>

    </data>
</openerp>
